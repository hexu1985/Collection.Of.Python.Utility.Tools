<!DOCTYPE html>
<!-- saved from url=(0038)https://zhuanlan.zhihu.com/p/503280155 -->
<html lang="zh" data-hairline="true" class="itcauecng" data-theme="light" data-rh="data-theme"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>PyTorch保姆级CNN实现mnist手写数字识别 - 知乎</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=10,chrome=1"><meta name="google-site-verification" content="FTeR0c8arOPKh8c5DYh_9uu98_zJbaWw53J-Sch9MTg"><meta data-rh="true" name="keywords" content="手写数字识别,深度学习（Deep Learning）,卷积神经网络（CNN）"><meta data-rh="true" name="description" content="前言： 毕业之后从事cv工作有两三年，从最初的卷积神经网络搭建，到现在目标检测、语义分割，一步步走来，遇到了太多的坑，本文从如何快速、清晰的实现一个cv的helloword之mnist手写数字识别。本文是新手级教程，…"><meta data-rh="true" property="og:title" content="PyTorch保姆级CNN实现mnist手写数字识别"><meta data-rh="true" property="og:url" content="https://zhuanlan.zhihu.com/p/503280155"><meta data-rh="true" property="og:description" content="前言： 毕业之后从事cv工作有两三年，从最初的卷积神经网络搭建，到现在目标检测、语义分割，一步步走来，遇到了太多的坑，本文从如何快速、清晰的实现一个cv的helloword之mnist手写数字识别。本文是新手级教程，…"><meta data-rh="true" property="og:image" content="https://pic1.zhimg.com/v2-f08486417921004ec3292531e30c6683_720w.jpg?source=172ae18b"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="og:site_name" content="知乎专栏"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.81060cab.png"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.81060cab.png" sizes="152x152"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-120.d5793cac.png" sizes="120x120"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-76.7abf3393.png" sizes="76x76"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-60.362a8eac.png" sizes="60x60"><link crossorigin="" rel="shortcut icon" type="image/x-icon" href="https://static.zhihu.com/heifetz/favicon.ico"><link crossorigin="" rel="search" type="application/opensearchdescription+xml" href="https://static.zhihu.com/heifetz/search.xml" title="知乎"><link rel="dns-prefetch" href="https://static.zhimg.com/"><link rel="dns-prefetch" href="https://pica.zhimg.com/"><link rel="dns-prefetch" href="https://picx.zhimg.com/"><link rel="dns-prefetch" href="https://pic1.zhimg.com/"><link rel="dns-prefetch" href="https://pic2.zhimg.com/"><link rel="dns-prefetch" href="https://pic3.zhimg.com/"><link rel="dns-prefetch" href="https://pic4.zhimg.com/"><link rel="dns-prefetch" href="https://static.zhihu.com/"><style data-emotion-css="9mvwt1">:root{--zhc-padding-horizontal:20px;--zhc-padding-vertical:16px;--zhc-notification-top:75px;--app-padding:16px;--app-header-height:52px;--app-max-width:640px;--app-width:1000px;--app-font-size:15px;}</style><script nonce="" data-web-reporter-config="{&quot;platform&quot;:&quot;web&quot;,&quot;project&quot;:&quot;heifetz&quot;}">!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).webReporter={})}(this,function(e){"use strict";var t={},n=!1,o=function(){var e,o,r,a,i;return n||(e=document.querySelector("script[data-web-reporter-config]"),o=e&&e.dataset.webReporterConfig||"{}",r=JSON.parse(o),a=r.platform,i=r.project,t={platform:a,project:i},n=!0),t};function r(e){return a(function(){return localStorage.getItem(e)})()}function a(e){return function(){try{return e.apply(void 0,arguments)}catch(e){}}}var i=a(function(e,t){var n={platform:"web",project:o().project,clientTimestamp:+new Date};!function(e,t,n){"1"===r("weber:logenabled")&&console.log("[web-reporter]%o",{type:e,base:t,data:n})}(e,n,t),function(e,t){var n=btoa(JSON.stringify(t));if("undefined"!=typeof Blob&&window.navigator&&window.navigator.sendBeacon){var o=new Blob([n],{type:"text/plain"});navigator.sendBeacon(e,o)}else{var r=new XMLHttpRequest;r.open("POST",e),r.withCredentials=!1,r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),r.send(n)}}(r("weber:api")||"https://apm.zhihu.com/collector/web_json",{type:e,base:n,data:t})});e.report=i,Object.defineProperty(e,"__esModule",{value:!0})});
</script><link href="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/3555.216a26f4.eadefe8d5e828d4e99e7.css" crossorigin="" rel="stylesheet"><link href="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/column.216a26f4.2c6bc29d03f98e987815.css" crossorigin="" rel="stylesheet"><link rel="stylesheet" type="text/css" href="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/user-hover-card.216a26f4.0e3930e2ffc649f7ed8b.css" crossorigin="anonymous"><link rel="stylesheet" type="text/css" href="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/GoodsRecommendGoodsCardList.216a26f4.d95ce79191cdf8d7ac28.css" crossorigin="anonymous"><link rel="stylesheet" type="text/css" href="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/report_modals.216a26f4.370935343bb8c3bca346.css" crossorigin="anonymous"><link rel="stylesheet" type="text/css" href="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/632.216a26f4.763aa082a89da06da92e.css" crossorigin="anonymous"><link rel="stylesheet" type="text/css" href="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/ECommerceAd.216a26f4.c90979d08ed65b86fc8f.css" crossorigin="anonymous"><link rel="stylesheet" type="text/css" href="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/1468.216a26f4.101bb14a2c1d8d20b744.css" crossorigin="anonymous"><link rel="stylesheet" type="text/css" href="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/EditableV2.216a26f4.6c9301eaad8df7e50cb2.css" crossorigin="anonymous"><script nonce="">!function(){"use strict";!function(e,n){var r=[];function t(e){return function(){r.push([e,arguments])}}n.Raven={captureException:t("captureException"),captureMessage:t("captureMessage"),captureBreadcrumb:t("captureBreadcrumb")};var a,o,c,i,s,u="undefined"!=typeof DOMError;function d(e){var n=e instanceof Error||e instanceof ErrorEvent||u&&e instanceof DOMError||e instanceof DOMException;Raven.captureException(n?e:new Error(e.message||e.reason))}n.addEventListener("unhandledrejection",d),n.addEventListener("error",d,!0),a=e.src,o=e,c=function(){r.forEach(function(e){var n;(n=Raven)[e[0]].apply(n,e[1])}),n.removeEventListener("unhandledrejection",d),n.removeEventListener("error",d,!0)},i=document.head||document.getElementsByTagName("head")[0],(s=document.createElement("script")).crossOrigin=o.crossOrigin,s.dataset.sentryConfig=o["data-sentry-config"],s.onload=c,s.src=a,i.appendChild(s)}({"defer":true,"crossOrigin":"anonymous","src":"https://unpkg.zhimg.com/@cfe/sentry-script@1.3.1/dist/init.js","data-sentry-config":"{\"dsn\":\"https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224\",\"sampleRate\":0.1,\"release\":\"1357-9b898476\",\"ignoreErrorNames\":[\"NetworkError\",\"SecurityError\"],\"ignoreErrorsPreset\":\"ReactApp\",\"tags\":{\"app_name\":\"heifetz\"}}"},window)}();
</script><script crossorigin="anonymous" data-sentry-config="{&quot;dsn&quot;:&quot;https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224&quot;,&quot;sampleRate&quot;:0.1,&quot;release&quot;:&quot;1357-9b898476&quot;,&quot;ignoreErrorNames&quot;:[&quot;NetworkError&quot;,&quot;SecurityError&quot;],&quot;ignoreErrorsPreset&quot;:&quot;ReactApp&quot;,&quot;tags&quot;:{&quot;app_name&quot;:&quot;heifetz&quot;}}" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/init.js"></script><style data-emotion-css="55n9hh">.css-55n9hh{position:fixed;top:0;right:0;left:0;z-index:101;display:none;height:2px;pointer-events:none;background:#1772F6;-webkit-transform:translateX(-100%);-ms-transform:translateX(-100%);transform:translateX(-100%);}</style><style data-emotion-css="1l12z7y">.css-1l12z7y{box-shadow:0px 16px 32px rgba(0,0,0,0.04);}</style><style data-emotion-css="1hlrcxk">.css-1hlrcxk{-webkit-transition-property:fill;transition-property:fill;-webkit-transition-duration:0.25s;transition-duration:0.25s;-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;}</style><style data-emotion-css="icip60">.css-icip60{border-radius:2px;}</style><style data-emotion-css="fnnb9l">.css-fnnb9l{box-sizing:border-box;margin:0;min-width:0;max-width:100%;height:auto;background-color:#ffffff;width:30px;height:30px;border-radius:2px;}</style><style data-emotion-css="78p1r9">.css-78p1r9{box-sizing:border-box;margin:0;min-width:0;margin-left:auto;margin-right:auto;max-width:690px;margin-top:0;}@media screen and (min-width:40em){.css-78p1r9{margin-top:1em;}}</style><style data-emotion-css="1owvvir">.css-1owvvir{position:relative;padding-bottom:53.5%;height:0;border-radius:inherit;}</style><style data-emotion-css="w1n5cy">.css-w1n5cy{box-sizing:border-box;margin:0;min-width:0;position:relative;padding-bottom:53.5%;height:0;border-radius:inherit;}</style><style data-emotion-css="1ld0bim">.css-1ld0bim{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:inherit;}</style><style data-emotion-css="uodor8">.css-uodor8{border-radius:50%;}</style><style data-emotion-css="1syywx2">.css-1syywx2{box-sizing:border-box;margin:0;min-width:0;max-width:100%;height:auto;background-color:#ffffff;width:38px;height:38px;border-radius:50%;}</style><style data-emotion-css="1cd9gw4">.css-1cd9gw4{margin-left:.3em;}</style><style data-emotion-css="z4ujak">.css-z4ujak{color:#8491a5;}</style><style data-emotion-css="1od93p9">.css-1od93p9{margin-top:16px;position:relative;}</style><style data-emotion-css="376mun">.css-376mun{position:relative;display:inline;}</style><style data-emotion-css="1dlndns">.css-1dlndns{position:absolute;left:NaNpx;top:0;}</style><style data-emotion-css="ldd79s">.css-ldd79s{box-sizing:border-box;margin:0;min-width:0;position:absolute;left:NaNpx;top:0;}</style><style data-emotion-css="dg64xe">.css-dg64xe .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(248,248,250,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-dg64xe .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-dg64xe .FileLinkCard-info{margin-left:12px;}.css-dg64xe .FileLinkCard-name{color:#191B1F;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-dg64xe .FileLinkCard-meta{color:#9196a1;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-dg64xe .FileLinkCard-source{white-space:pre;}.css-dg64xe img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}.css-dg64xe img.content_image[data-size="normal"],.css-dg64xe img.origin_image[data-size="normal"]{width:100%;max-width:100%;}.css-dg64xe img.content_image[data-size="small"],.css-dg64xe img.origin_image[data-size="small"]{width:320px;max-width:100%;}</style><style data-emotion-css="1vqsdx1">.css-1vqsdx1 .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#f8f8fa;}.css-1vqsdx1 .LinkCard.new,.css-1vqsdx1 .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1vqsdx1 .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-1vqsdx1 .LinkCard.new .LinkCard-contents .loading{height:14px;background:#ebeced;border-radius:7px;}.css-1vqsdx1 .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-1vqsdx1 .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#191B1F;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-1vqsdx1 .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#9196a1;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1vqsdx1 .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#373a40;}.css-1vqsdx1 .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#9196a1;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1vqsdx1 .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-1vqsdx1 .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(196,199,206,0.3);}.css-1vqsdx1 .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-1vqsdx1 .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-1vqsdx1 .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#ebeced;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-1vqsdx1 .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#ebeced;color:#c4c7ce;}.css-1vqsdx1 .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#9196a1;}.css-1vqsdx1 .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-1vqsdx1 .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-1vqsdx1 .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#373a40;}.css-1vqsdx1 .LinkCard.new .LinkCard-richText .text{color:#373a40;}.css-1vqsdx1 .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-1vqsdx1 .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-1vqsdx1 .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-1vqsdx1 .LinkCard.old,.css-1vqsdx1 .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(248,248,250,0.88);color:#c4c7ce;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#ebeced;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#ebeced;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}</style><style data-emotion-css="yxro2d">.css-yxro2d .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-yxro2d .LinkCard.old,.css-yxro2d .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-yxro2d .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(248,248,250,0.88);color:#c4c7ce;}.css-yxro2d .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#ebeced;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-yxro2d .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#ebeced;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}.css-yxro2d .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#f8f8fa;}.css-yxro2d .LinkCard.new,.css-yxro2d .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-yxro2d .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-yxro2d .LinkCard.new .LinkCard-contents .loading{height:14px;background:#ebeced;border-radius:7px;}.css-yxro2d .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-yxro2d .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#191B1F;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yxro2d .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-yxro2d .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-yxro2d .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-yxro2d .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-yxro2d .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#9196a1;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yxro2d .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#373a40;}.css-yxro2d .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#9196a1;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yxro2d .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-yxro2d .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(196,199,206,0.3);}.css-yxro2d .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-yxro2d .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-yxro2d .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#ebeced;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-yxro2d .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#ebeced;color:#c4c7ce;}.css-yxro2d .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#9196a1;}.css-yxro2d .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-yxro2d .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-yxro2d .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#373a40;}.css-yxro2d .LinkCard.new .LinkCard-richText .text{color:#373a40;}.css-yxro2d .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-yxro2d .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-yxro2d .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(248,248,250,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-yxro2d .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-yxro2d .FileLinkCard-info{margin-left:12px;}.css-yxro2d .FileLinkCard-name{color:#191B1F;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-yxro2d .FileLinkCard-meta{color:#9196a1;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-yxro2d .FileLinkCard-source{white-space:pre;}.css-yxro2d img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}.css-yxro2d img.content_image[data-size="normal"],.css-yxro2d img.origin_image[data-size="normal"]{width:100%;max-width:100%;}.css-yxro2d img.content_image[data-size="small"],.css-yxro2d img.origin_image[data-size="small"]{width:320px;max-width:100%;}</style><style data-emotion-css="jflero animation-1yvu044">.css-jflero{word-break:break-word;line-height:1.6;}.css-jflero > [data-first-child]{margin-top:0;}.css-jflero > :last-child{margin-bottom:0;}.css-jflero h1,.css-jflero h2{clear:left;margin-top:calc((1.4em * 2) / 1.2);margin-bottom:calc(1.4em / 1.2);font-size:1.2em;line-height:1.5;font-weight:600;}.css-jflero h3,.css-jflero h4,.css-jflero h5,.css-jflero h6{clear:left;margin-top:calc((1.4em * 1.5) / 1.1);margin-bottom:calc(1.4em / 1.1);font-size:1.1em;line-height:1.5;font-weight:600;}.css-jflero u{-webkit-text-decoration:none;text-decoration:none;border-bottom:1px solid #373a40;}.css-jflero b{font-weight:600;}.css-jflero sup{font-size:0.8em;}.css-jflero sup[data-draft-type='reference']{color:#09408e;}.css-jflero a:focus{outline:none;-webkit-transition:box-shadow 0.3s;transition:box-shadow 0.3s;}html[data-focus-visible] .css-jflero a:focus{box-shadow:0 0 0 2px #ffffff,0 0 0 4px rgba(23,114,246,0.3);}.css-jflero a.ztext-link,.css-jflero a.internal,.css-jflero a.external{-webkit-text-decoration:none;text-decoration:none;cursor:pointer;border-bottom:1px solid #81858f;}.css-jflero a.ztext-link:hover,.css-jflero a.internal:hover,.css-jflero a.external:hover{color:#09408e;border-bottom:1px solid #09408e;}.css-jflero a.ztext-link > .ellipsis::after,.css-jflero a.internal > .ellipsis::after,.css-jflero a.external > .ellipsis::after{content:'...';}.css-jflero a.ztext-link > .invisible,.css-jflero a.internal > .invisible,.css-jflero a.external > .invisible{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;}.css-jflero a.ztext-link u,.css-jflero a.internal u,.css-jflero a.external u{border:none;}.css-jflero a.member_mention{color:#09408e;}.css-jflero a.member_mention:hover{border-bottom:1px solid #09408e;}.css-jflero a.UserLink-link{color:#09408e;}.css-jflero a.UserLink-link:hover{border-bottom:1px solid #09408e;}.css-jflero p{margin:1.4em 0;}.css-jflero p.ztext-empty-paragraph{margin:calc((2.8em- (1.4em * 2 + 1.6em)) / 2) 0;}.css-jflero p.ztext-empty-paragraph + .ztext-empty-paragraph{margin:1.4em 0;}.css-jflero hr{margin:4em auto;width:240px;max-width:100%;border:none;border-top:1px solid #c4c7ce;}.css-jflero img[eeimg]{max-width:100%;vertical-align:middle;}.css-jflero img[eeimg="1"]{margin:0 3px;max-width:calc(100% - 6px);display:inline-block;}.css-jflero img[eeimg="2"]{margin:1.4em auto;display:block;}.css-jflero blockquote{margin:1.4em 0;padding-left:1em;color:#535861;border-left:3px solid #c4c7ce;}.css-jflero ol,.css-jflero ul{margin:1.4em 0;padding:0;width:100%;}.css-jflero ol ol,.css-jflero ul ol,.css-jflero ol ul,.css-jflero ul ul{margin:0;}.css-jflero ol li::before,.css-jflero ul li::before{width:1em;}.css-jflero ol > ol,.css-jflero ul > ol,.css-jflero ol > ul,.css-jflero ul > ul{padding-left:1em;box-sizing:border-box;}.css-jflero ul>li{display:table;width:100%;list-style:none;}.css-jflero ul>li::before{display:table-cell;content:'•  ';white-space:pre;}.css-jflero ol{counter-reset:ol;}.css-jflero ol > li{display:table;width:100%;list-style:none;}.css-jflero ol > li::before{display:table-cell;text-align:right;counter-increment:ol;content:counter(ol) '. ';white-space:pre;}.css-jflero ol ol{counter-reset:ol2;}.css-jflero ol ol li::before{counter-increment:ol2;content:counter(ol2) '. ';}.css-jflero ol ol ol{counter-reset:ol3;}.css-jflero ol ol ol li::before{counter-increment:ol3;content:counter(ol3) '. ';}.css-jflero ol ol ol ol{counter-reset:ol4;}.css-jflero ol ol ol ol li::before{counter-increment:ol4;content:counter(ol4) '. ';}.css-jflero figure{margin:1.4em 0;}.css-jflero figure .content_image,.css-jflero figure .origin_image{margin:0 auto;}.css-jflero figure figcaption{margin-top:calc(0.6em / 0.9);padding:0 1em;font-size:0.9em;line-height:1.5;text-align:center;color:#9196a1;}.css-jflero figure + figure{margin-top:calc(1.4em * 1.6);}.css-jflero figure[data-size='small'],.css-jflero figure:not([data-size]) > [data-size='small']{clear:both;}.css-jflero figure[data-size='left'],.css-jflero figure:not([data-size]) > [data-size='left']{float:left;margin:0 20px 20px 0;max-width:33%;}.css-jflero figure[data-size='right'],.css-jflero figure:not([data-size]) > [data-size='right']{float:right;margin:0 0 20px 20px;max-width:33%;}.css-jflero figure[data-size='collapse']{margin-bottom:0;}.css-jflero figure[data-size='collapse'] + figure{margin-top:0;}.css-jflero .content_image,.css-jflero .origin_image{display:block;max-width:100%;height:auto;margin:1.4em auto;}.css-jflero .content_image[data-size='small'],.css-jflero .origin_image[data-size='small']{max-width:40%;}.css-jflero .content_image.zh-lightbox-thumb,.css-jflero .origin_image.zh-lightbox-thumb{cursor:-webkit-zoom-in;cursor:-moz-zoom-in;cursor:zoom-in;}.css-jflero code{margin:0 2px;padding:3px 4px;border-radius:3px;font-family:Menlo,Monaco,Consolas,'Andale Mono','lucida console','Courier New',monospace;font-size:0.9em;background-color:#f8f8fa;}.css-jflero pre{margin:1.4em 0;padding:calc(0.8em / 0.9);font-size:0.9em;word-break:initial;word-wrap:initial;white-space:pre;overflow:auto;-webkit-overflow-scrolling:touch;background:#f8f8fa;border-radius:4px;}.css-jflero pre code{margin:0;padding:0;font-size:inherit;border-radius:0;background-color:inherit;}.css-jflero li pre{white-space:pre-wrap;}.css-jflero table[data-draft-type='table']{border-collapse:collapse;font-size:15px;margin:1.4em auto;max-width:100%;table-layout:fixed;text-align:left;width:100%;}.css-jflero table[data-draft-type='table'][data-size='small']{min-width:260px;width:40%;}.css-jflero table[data-draft-type='table'][data-row-style='striped'] tr:nth-of-type(2n + 1){background:#f8f8fa;}.css-jflero table[data-draft-type='table'] td,.css-jflero table[data-draft-type='table'] th{border:1px solid #c4c7ce;line-height:24px;height:24px;padding:3px 12px;}.css-jflero table[data-draft-type='table'] th{background:#ebeced;color:#191B1F;font-weight:500;}.css-jflero .video-box,.css-jflero .link-box{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin:1.4em 0;overflow:auto;white-space:normal;cursor:pointer;border:solid 1px #ebeced;border-radius:4px;}.css-jflero .lazy[data-lazy-status]{background-color:#f8f8fa;}.css-jflero .lazy[data-lazy-status="ok"]{background-color:transparent;-webkit-animation:animation-1yvu044 0.5s ease-in;animation:animation-1yvu044 0.5s ease-in;}.css-jflero .highlight{margin:1em 0;}.css-jflero .highlight pre{margin:0;}.css-jflero .highlight .hll{background-color:#f8f8fa;}.css-jflero .highlight .c{font-style:italic;color:#9196a1;}.css-jflero .highlight .err{color:#D95350;}.css-jflero .highlight .k{font-weight:600;}.css-jflero .highlight .o{font-weight:600;}.css-jflero .highlight .cm{font-style:italic;color:#9196a1;}.css-jflero .highlight .cp{font-weight:600;color:#9196a1;}.css-jflero .highlight .c1{font-style:italic;color:#9196a1;}.css-jflero .highlight .cs{font-style:italic;font-weight:600;color:#9196a1;}.css-jflero .highlight .gd{color:#F05159;}.css-jflero .highlight .ge{font-style:italic;}.css-jflero .highlight .gr{color:#D95350;}.css-jflero .highlight .gh{color:#9196a1;}.css-jflero .highlight .gi{color:#12b370;}.css-jflero .highlight .go{color:#81858f;}.css-jflero .highlight .gp{color:#535861;}.css-jflero .highlight .gs{font-weight:600;}.css-jflero .highlight .gu{color:#9196a1;}.css-jflero .highlight .gt{color:#D95350;}.css-jflero .highlight .kc{font-weight:600;}.css-jflero .highlight .kd{font-weight:600;}.css-jflero .highlight .kn{font-weight:600;}.css-jflero .highlight .kp{font-weight:600;}.css-jflero .highlight .kr{font-weight:600;}.css-jflero .highlight .kt{font-weight:600;color:#09408e;}.css-jflero .highlight .m{color:#1772F6;}.css-jflero .highlight .s{color:#D95350;}.css-jflero .highlight .na{color:#1772F6;}.css-jflero .highlight .nb{color:#1772F6;}.css-jflero .highlight .nc{font-weight:600;color:#09408e;}.css-jflero .highlight .no{color:#1772F6;}.css-jflero .highlight .ni{color:#6A5FF3;}.css-jflero .highlight .ne{font-weight:600;color:#D95350;}.css-jflero .highlight .nf{font-weight:600;color:#D95350;}.css-jflero .highlight .nn{color:#535861;}.css-jflero .highlight .nt{color:#09408e;}.css-jflero .highlight .nv{color:#1772F6;}.css-jflero .highlight .ow{font-weight:600;}.css-jflero .highlight .w{color:#adb1b7;}.css-jflero .highlight .mf{color:#1772F6;}.css-jflero .highlight .mh{color:#1772F6;}.css-jflero .highlight .mi{color:#1772F6;}.css-jflero .highlight .mo{color:#1772F6;}.css-jflero .highlight .sb{color:#D95350;}.css-jflero .highlight .sc{color:#D95350;}.css-jflero .highlight .sd{color:#D95350;}.css-jflero .highlight .s2{color:#D95350;}.css-jflero .highlight .se{color:#D95350;}.css-jflero .highlight .sh{color:#D95350;}.css-jflero .highlight .si{color:#D95350;}.css-jflero .highlight .sx{color:#D95350;}.css-jflero .highlight .sr{color:#A5542F;}.css-jflero .highlight .s1{color:#D95350;}.css-jflero .highlight .ss{color:#D95350;}.css-jflero .highlight .bp{color:#9196a1;}.css-jflero .highlight .vc{color:#1772F6;}.css-jflero .highlight .vg{color:#1772F6;}.css-jflero .highlight .vi{color:#1772F6;}.css-jflero .highlight .il{color:#1772F6;}.css-jflero .highlight::-webkit-scrollbar{width:6px;height:6px;}.css-jflero .highlight::-webkit-scrollbar-thumb:horizontal{background-color:rgba(25,27,31,0.5);border-radius:6px;}.css-jflero .highlight::-webkit-scrollbar-thumb:horizontal:hover{background-color:rgba(25,27,31,0.6);}.css-jflero .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-jflero .LinkCard.old,.css-jflero .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-jflero .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(248,248,250,0.88);color:#c4c7ce;}.css-jflero .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#ebeced;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-jflero .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-jflero .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-jflero .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#ebeced;}.css-jflero .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-jflero .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}.css-jflero .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#f8f8fa;}.css-jflero .LinkCard.new,.css-jflero .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-jflero .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-jflero .LinkCard.new .LinkCard-contents .loading{height:14px;background:#ebeced;border-radius:7px;}.css-jflero .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-jflero .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#191B1F;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-jflero .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-jflero .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-jflero .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-jflero .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-jflero .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#9196a1;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-jflero .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#373a40;}.css-jflero .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#9196a1;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-jflero .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-jflero .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(196,199,206,0.3);}.css-jflero .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-jflero .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-jflero .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#ebeced;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-jflero .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#ebeced;color:#c4c7ce;}.css-jflero .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#9196a1;}.css-jflero .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-jflero .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-jflero .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#373a40;}.css-jflero .LinkCard.new .LinkCard-richText .text{color:#373a40;}.css-jflero .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-jflero .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-jflero .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(248,248,250,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-jflero .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-jflero .FileLinkCard-info{margin-left:12px;}.css-jflero .FileLinkCard-name{color:#191B1F;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-jflero .FileLinkCard-meta{color:#9196a1;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-jflero .FileLinkCard-source{white-space:pre;}.css-jflero img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}.css-jflero img.content_image[data-size="normal"],.css-jflero img.origin_image[data-size="normal"]{width:100%;max-width:100%;}.css-jflero img.content_image[data-size="small"],.css-jflero img.origin_image[data-size="small"]{width:320px;max-width:100%;}@-webkit-keyframes animation-1yvu044{from{opacity:0;}to{opacity:1;}}@keyframes animation-1yvu044{from{opacity:0;}to{opacity:1;}}</style><style data-emotion-css="ch8ocw">.css-ch8ocw{position:relative;display:inline-block;height:30px;padding:0 12px;font-size:14px;line-height:30px;color:#1772F6;vertical-align:top;border-radius:100px;background:rgba(23,114,246,0.1);}.css-ch8ocw:hover{background-color:rgba(23,114,246,0.15);}</style><style data-emotion-css="1xlfegr">.css-1xlfegr{background:transparent;box-shadow:none;}</style><style data-emotion-css="1gomreu">.css-1gomreu{position:relative;display:inline-block;}</style><style type="text/css">.Marquee_module_marquee__218919a6 {
  overflow: hidden;
}

.Marquee_module_marqueeText__218919a6 {
  position: relative;
  transition: all 0.5s ease-in-out;
}
.Marquee_module_noAnimation__218919a6 {
  transition: none;
}

.Marquee_module_marqueeItem__218919a6 {
  display: flex;
  align-items: center;
  flex-wrap: nowrap;
  overflow: hidden;
  flex: 1;
}
</style><style data-emotion="css"></style></head><body class="WhiteBg-body PostIndex-body" aria-basefontsize="16" data-rh="class"><a id="ariaTipText" role="pagedescription" aria-label="欢迎进入 PyTorch保姆级CNN实现mnist手写数字识别 - 知乎,盲人用户使用操作智能引导，请按快捷键Ctrl+Alt+R；阅读详细操作说明请按快捷键Ctrl+Alt+问号键。" aria-atomic="true" href="javascript:void(0)" class="skipAutoFix" style="width: 1px; height: 1px;"><img src="https://zhuanlan.zhihu.com/p/503280155" style="width:1px !important;height:1px !important;position:absolute;top:0;"></a><div id="root"><div class="App"><div class="LoadingBar  css-55n9hh"></div><div><span style="position:absolute;top:-10000px;left:-10000px" role="log" aria-live="assertive"></span></div><main role="main" class="App-main"><div class="Post-content" data-zop-usertoken="{&quot;userToken&quot;:&quot;hexu1985&quot;}" data-zop="{&quot;authorName&quot;:&quot;张云飞&quot;,&quot;itemId&quot;:503280155,&quot;title&quot;:&quot;PyTorch保姆级CNN实现mnist手写数字识别&quot;,&quot;type&quot;:&quot;article&quot;}" data-za-detail-view-path-module="PostItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Post&quot;,&quot;token&quot;:&quot;503280155&quot;}}}"><div class="ColumnPageHeader-Wrapper"><div><div class="Sticky ColumnPageHeader is-fixed css-1l12z7y" style="width: 1702px; top: 0px; left: 0px;"><div class="ColumnPageHeader-content"><a href="https://www.zhihu.com/" aria-label="知乎"><svg viewBox="0 0 64 30" fill="#1772F6" width="64" height="30" class="css-1hlrcxk"><path d="M29.05 4.582H16.733V25.94h3.018l.403 2.572 4.081-2.572h4.815V4.582zm-5.207 18.69l-2.396 1.509-.235-1.508h-1.724V7.233h6.78v16.04h-2.425zM14.46 14.191H9.982c0-.471.033-.954.039-1.458v-5.5h5.106V5.935a1.352 1.352 0 0 0-.404-.957 1.378 1.378 0 0 0-.968-.396H5.783c.028-.088.056-.177.084-.255.274-.82 1.153-3.326 1.153-3.326a4.262 4.262 0 0 0-2.413.698c-.57.4-.912.682-1.371 1.946-.532 1.453-.997 2.856-1.31 3.693C1.444 8.674.28 11.025.28 11.025a5.85 5.85 0 0 0 2.52-.61c1.119-.593 1.679-1.502 2.054-2.883l.09-.3h2.334v5.5c0 .5-.045.982-.073 1.46h-4.12c-.71 0-1.39.278-1.893.775a2.638 2.638 0 0 0-.783 1.874h6.527a17.717 17.717 0 0 1-.778 3.649 16.796 16.796 0 0 1-3.012 5.273A33.104 33.104 0 0 1 0 28.74s3.13 1.175 5.425-.954c1.388-1.292 2.631-3.814 3.23-5.727a28.09 28.09 0 0 0 1.12-5.229h5.967v-1.37a1.254 1.254 0 0 0-.373-.899 1.279 1.279 0 0 0-.909-.37z"></path><path d="M11.27 19.675l-2.312 1.491 5.038 7.458a6.905 6.905 0 0 0 .672-2.218 3.15 3.15 0 0 0-.28-2.168l-3.118-4.563zM51.449 15.195V5.842c4.181-.205 7.988-.405 9.438-.483l.851-.05c.387-.399.885-2.395.689-3.021-.073-.25-.213-.666-.638-.555a33.279 33.279 0 0 1-4.277.727c-2.766.321-3.97.404-7.804.682-6.718.487-12.709.72-12.709.72a2.518 2.518 0 0 0 .788 1.834 2.567 2.567 0 0 0 1.883.706c2.278-.095 5.598-.25 8.996-.41v9.203h-12.78c0 .703.281 1.377.783 1.874a2.69 2.69 0 0 0 1.892.777h10.105v7.075c0 .887-.464 1.192-1.231 1.214h-3.92a4.15 4.15 0 0 0 .837 1.544 4.2 4.2 0 0 0 1.403 1.067 6.215 6.215 0 0 0 2.71.277c1.36-.066 2.967-.826 2.967-3.57v-7.607h11.28c.342 0 .67-.135.91-.374.242-.239.378-.563.378-.902v-1.375H51.449z"></path><path d="M42.614 8.873a2.304 2.304 0 0 0-1.508-.926 2.334 2.334 0 0 0-1.727.405l-.376.272 4.255 5.85 2.24-1.62-2.884-3.98zM57.35 8.68l-3.125 4.097 2.24 1.663 4.517-5.927-.375-.277a2.32 2.32 0 0 0-1.722-.452 2.327 2.327 0 0 0-1.536.896z"></path></svg></a><div class="ColumnPageHeader-Button"><div class="Popover"><button title="更多" id="Popover1-toggle" aria-haspopup="true" aria-expanded="false" type="button" class="Button ColumnPageHeader-MenuToggler FEfUrdfMIKpQDJDqkjte Button--plain fEPKGkUK5jyc4fUuT0QP"><svg width="24" height="24" viewBox="0 0 24 24" class="Zi Zi--Dots" fill="currentColor"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></button></div><button type="button" class="Button ColumnPageHeader-WriteButton FEfUrdfMIKpQDJDqkjte Button--blue JmYzaky7MEPMFcJDLNMG"><svg width="24" height="24" viewBox="0 0 24 24" class="Zi Zi--EditSurround" fill="currentColor"><path d="M4.352 6.804A2.554 2.554 0 0 1 6.905 4.25h6.072a.875.875 0 0 0 0-1.75H6.905a4.304 4.304 0 0 0-4.303 4.304v10.142a4.304 4.304 0 0 0 4.303 4.304h10.143a4.304 4.304 0 0 0 4.304-4.304v-6.071a.875.875 0 0 0-1.75 0v6.071a2.554 2.554 0 0 1-2.554 2.554H6.905a2.554 2.554 0 0 1-2.553-2.554V6.804Z"></path><path d="M20.595 4.731a.875.875 0 1 0-1.237-1.237l-7.763 7.762a.875.875 0 1 0 1.238 1.238l7.762-7.763Z"></path></svg>写文章</button></div></div><div class="ColumnPageHeader-profile"><div class="Popover AppHeader-menu"><button id="Popover4-toggle" aria-haspopup="true" aria-expanded="false" type="button" class="Button AppHeader-profileEntry FEfUrdfMIKpQDJDqkjte Button--plain fEPKGkUK5jyc4fUuT0QP"><img class="Avatar AppHeader-profileAvatar css-fnnb9l" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg" srcset="https://pic1.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=32738c0c 2x" alt="点击打开hexu1985的主页"></button></div><div class="Popover ddLajxN_Q0AuobBZjX9m AppHeaderProfileMenu-creatorHintPopover"><div class="AppHeaderProfileMenu-creatorHintToggler" id="Popover5-toggle" aria-haspopup="true" aria-expanded="false"></div></div></div></div><div class="Sticky--holder" style="position: relative; inset: 0px; display: block; float: none; margin: 0px; height: 52px;"></div></div></div><div class="css-78p1r9"><div class="css-w1n5cy"><div class="css-1ld0bim"><span style="box-sizing:border-box;display:block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0"><picture><source type="image/avif" srcset="https://pic1.zhimg.com/70/v2-f08486417921004ec3292531e30c6683_1440w.avis?source=172ae18b&amp;biz_tag=Post 1x, https://pic1.zhimg.com/70/v2-f08486417921004ec3292531e30c6683_1440w.avis?source=172ae18b&amp;biz_tag=Post 2x" src="https://pic1.zhimg.com/70/v2-f08486417921004ec3292531e30c6683_1440w.avis?source=172ae18b&amp;biz_tag=Post"><source type="image/webp" srcset="https://pic1.zhimg.com/70/v2-f08486417921004ec3292531e30c6683_1440w.awebp?source=172ae18b&amp;biz_tag=Post 1x, https://pic1.zhimg.com/70/v2-f08486417921004ec3292531e30c6683_1440w.awebp?source=172ae18b&amp;biz_tag=Post 2x" src="https://pic1.zhimg.com/70/v2-f08486417921004ec3292531e30c6683_1440w.awebp?source=172ae18b&amp;biz_tag=Post"><img alt="PyTorch保姆级CNN实现mnist手写数字识别" decoding="async" style="position: absolute; inset: 0px; box-sizing: border-box; padding: 0px; border: none; margin: auto; display: block; width: 0px; height: 0px; min-width: 100%; max-width: 100%; min-height: 100%; max-height: 100%;" width="100%" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-f08486417921004ec3292531e30c6683_1440w.image" srcset="https://pic1.zhimg.com/70/v2-f08486417921004ec3292531e30c6683_1440w.image?source=172ae18b&amp;biz_tag=Post 1x, https://pic1.zhimg.com/70/v2-f08486417921004ec3292531e30c6683_1440w.image?source=172ae18b&amp;biz_tag=Post 2x"></picture></span></div></div></div><article class="Post-Main Post-NormalMain" tabindex="-1"><header class="Post-Header"><h1 class="Post-Title">PyTorch保姆级CNN实现mnist手写数字识别</h1><div class="Post-Author"><div class="AuthorInfo" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><div class="AuthorInfo"><meta itemprop="name" content="张云飞"><meta itemprop="image" content="https://pica.zhimg.com/v2-7e8a664d6eaebdd351fced054cee2f6b_l.jpg?source=172ae18b"><meta itemprop="url" content="https://www.zhihu.com/people/zhang-yun-fei-15-29"><meta itemprop="zhihu:followerCount"><span class="UserLink AuthorInfo-avatarWrapper"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/zhang-yun-fei-15-29" target="_blank" class="UserLink-link" data-za-detail-view-element_name="User"><img class="Avatar AuthorInfo-avatar css-1syywx2" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-7e8a664d6eaebdd351fced054cee2f6b_l.jpg" srcset="https://pica.zhimg.com/v2-7e8a664d6eaebdd351fced054cee2f6b_l.jpg?source=172ae18b 2x" alt="张云飞"></a></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/zhang-yun-fei-15-29" target="_blank" class="UserLink-link" data-za-detail-view-element_name="User">张云飞</a></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText css-0">君子慎独卑以自牧</div></div></div></div></div></div><button type="button" class="Button FollowButton FEfUrdfMIKpQDJDqkjte Button--primary Button--blue epMJl0lFQuYbC7jrwr_o JmYzaky7MEPMFcJDLNMG"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Plus FollowButton-icon" fill="currentColor"><path fill-rule="evenodd" d="M13.25 3.25a1.25 1.25 0 1 0-2.5 0v7.5h-7.5a1.25 1.25 0 1 0 0 2.5h7.5v7.5a1.25 1.25 0 1 0 2.5 0v-7.5h7.5a1.25 1.25 0 0 0 0-2.5h-7.5v-7.5Z" clip-rule="evenodd"></path></svg></span>关注他</button></div><div class="LabelContainer-wrapper"></div><div><div class="css-dvccr2"><div class="css-1lr85n">26 人赞同了该文章</div></div></div><span class="css-z4ujak"></span></header><div class="Post-RichTextContainer"><div class="css-1od93p9"><div class="css-376mun"><div class="css-l44lgl"><div class="css-15shh73"><div class="css-s1xz2x"><div><div class="Catalog isCatalogV2 css-17v5fjs" data-za-detail-view-name="正文"><div class="css-8kjoqe"><div class="css-1e6hvbc"><div class="css-zkfaav"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--Catalog24" fill="currentColor"><path d="M10 5a1 1 0 011-1h10a1 1 0 110 2H11a1 1 0 01-1-1zm4 6a1 1 0 100 2h7a1 1 0 100-2h-7zm0 7a1 1 0 100 2h7a1 1 0 100-2h-7zm-8.335.25a.915.915 0 01-.915-.915V12.75H10a.75.75 0 000-1.5H4.75V6.665c0-.505.41-.915.915-.915H7a.75.75 0 000-1.5H5.665A2.415 2.415 0 003.25 6.665v10.67a2.415 2.415 0 002.415 2.415H10a.75.75 0 000-1.5H5.665z"></path></svg></span><div class="css-5287jj">目录</div></div><div class="css-1ifd8ga">收起</div></div></div><div class="css-vm33ny"><div class="Catalog-content css-a3sv8e"><div class="Catalog-FirstLevelTitle Catalog-Title css-lvmdsl"><div data-catalog-target-id="h_503280155_0" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-byi3it"><div class="css-nj7ofv">代码地址：GitHub - zyf-xtu/DL: deep learning</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-1nds53c"><div data-catalog-target-id="h_503280155_1" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-h0sxub"><div class="css-nj7ofv">一、数据处理部分</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-1nds53c"><div data-catalog-target-id="h_503280155_2" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-h0sxub"><div class="css-nj7ofv">二、网络模型</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-1nds53c"><div data-catalog-target-id="h_503280155_3" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-h0sxub"><div class="css-nj7ofv">三、训练部分</div></div></div><div class="Catalog-SecondLevelTitle Catalog-Title css-1nds53c"><div data-catalog-target-id="h_503280155_4" data-za-detail-view-id="9745" data-za-detail-view-action="Click" data-za-detail-view-name="正文" class="css-h0sxub"><div class="css-nj7ofv">四、推理部分</div></div></div></div></div></div></div></div></div></div><div class="RichText ztext Post-RichText css-jflero" options="[object Object]"><p data-first-child="" data-pid="U3os1VNy">前言：</p><p data-pid="heIB7mgG">毕业之后从事cv工作有两三年，从最初的卷积神经网络搭建，到现在目标检测、语义分割，一步步走来，遇到了太多的坑，本文从如何快速、清晰的实现一个cv的helloword之mnist手写数字识别。本文是新手级教程，大佬勿喷！</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-10f99252ef61aac0363129ade893c30c_b.jpg" data-size="normal" data-rawwidth="500" data-rawheight="288" data-thumbnail="https://pic1.zhimg.com/v2-10f99252ef61aac0363129ade893c30c_720w.jpg?source=d16d100b" class="origin_image zh-lightbox-thumb" width="500" data-original="https://pic1.zhimg.com/v2-10f99252ef61aac0363129ade893c30c_r.jpg"/></noscript><div><div class="GifPlayer isPlaying css-g1g7n9" data-size="normal" data-za-detail-view-path-module="GifItem"><img class="ztext-gif GifPlayer-gif2mp4Image" width="500" role="presentation" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-10f99252ef61aac0363129ade893c30c_720w.jpg" data-thumbnail="https://pic1.zhimg.com/v2-10f99252ef61aac0363129ade893c30c_720w.jpg?source=d16d100b" data-size="normal" alt="动图封面" style="display: block;"><video class="ztext-gif GifPlayer-gif2mp4 css-1xeqk96" src="https://vdn3.vzuu.com/SD/aa5bdf08-c234-11ec-a81c-8e5e0960b224.mp4?disable_local_cache=1&amp;bu=078babd7&amp;c=avc.1.1&amp;f=mp4&amp;expiration=1716955583&amp;auth_key=1716955583-0-0-501a46aec57262594bf52a7ac9b973c2&amp;v=tx&amp;pu=078babd7" data-thumbnail="https://pic1.zhimg.com/v2-10f99252ef61aac0363129ade893c30c_720w.jpg?source=d16d100b" poster="https://pic1.zhimg.com/v2-10f99252ef61aac0363129ade893c30c_720w.jpg?source=d16d100b" data-size="normal" preload="metadata" loop="" playsinline=""></video><div class="GifPlayer-icon css-d39tw7"><svg width="50" height="50" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><ellipse fill="#000" opacity="0.45" cx="30" cy="30" rx="30" ry="30"></ellipse><ellipse stroke="#FFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" opacity="0.5" cx="30" cy="30" rx="26" ry="26"></ellipse></g><svg x="16" y="18.5"><g fill="#fff"><path x="100" y="100" d="M12.8422852,12.9814453 L12.8422852,11.3994141 L7.63916016,11.3994141 L7.63916016,13.0517578 L10.9086914,13.0517578 L10.9086914,13.3242188 C10.8911133,15.2050781 9.46728516,16.4707031 7.39306641,16.4707031 C5.01123047,16.4707031 3.51708984,14.625 3.51708984,11.6367188 C3.51708984,8.70117188 5.00244141,6.84667969 7.34912109,6.84667969 C9.08056641,6.84667969 10.284668,7.68164062 10.7768555,9.2109375 L12.7543945,9.2109375 C12.3237305,6.64453125 10.2319336,5.00976562 7.34912109,5.00976562 C3.79833984,5.00976562 1.50439453,7.61132812 1.50439453,11.6542969 C1.50439453,15.75 3.77197266,18.3076172 7.36669922,18.3076172 C10.6889648,18.3076172 12.8422852,16.2246094 12.8422852,12.9814453 Z M17.5180664,18 L17.5180664,5.31738281 L15.5493164,5.31738281 L15.5493164,18 L17.5180664,18 Z M22.659668,18 L22.659668,12.7441406 L28.1088867,12.7441406 L28.1088867,11.0039062 L22.659668,11.0039062 L22.659668,7.11035156 L28.6098633,7.11035156 L28.6098633,5.31738281 L20.690918,5.31738281 L20.690918,18 L22.659668,18 Z"></path></g></svg></svg></div></div></div><figcaption>CNN模型识别mnist</figcaption></figure><hr><h2 id="h_503280155_0" data-into-catalog-status="">代码地址：<a href="https://link.zhihu.com/?target=https%3A//github.com/zyf-xtu/DL" class=" wrap external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043">GitHub - zyf-xtu/DL: deep learning</a></h2><p data-pid="KfAJ24U4">在<span class="nolink">classification/zyf_mnist</span>目录下</p><p data-pid="iprCUbbd">如果对经典网络结构pytorch复现有兴趣的童鞋，请看我的关于Alexnet、VGG系列、Resnet系列、Inception系列等经典网络复现，具有超级详细的复现代码哦，地址：<a href="https://link.zhihu.com/?target=https%3A//github.com/zyf-xtu/pytorch_models" class=" external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043"><span class="invisible">https://</span><span class="visible">github.com/zyf-xtu/pyto</span><span class="invisible">rch_models</span><span class="ellipsis"></span></a></p><p data-pid="ep_u5P7R">言归正传，开启代码之旅--------</p><h3 id="h_503280155_1" data-into-catalog-status="">一、数据处理部分</h3><p data-pid="EE0Cu85O">mnist是一个手写字体的数字图像数据集，包含数字0-9共计70000张图像，其中训练集60000张测试集10000张，每张图像的大小为28*28。数据集详细介绍这里不讲了，有兴趣的同学可以查阅资料，数据集地址：<a href="https://link.zhihu.com/?target=http%3A//yann.lecun.com/exdb/mnist/" class=" external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043"><span class="invisible">http://</span><span class="visible">yann.lecun.com/exdb/mni</span><span class="invisible">st/</span><span class="ellipsis"></span></a></p><p data-pid="7HQVYsiJ">下载来的数据是784维度的数组，并不是图像数据，这时候数据也是可以用的，但是我们总会感觉不靠谱，因为看不到图像数据，所以首先我们要把下载来的数据转化成图像。</p><p data-pid="mvA7Nb2p">本文采用torchvision内部封装好的数据集部分torchvision.datasets来下载mnist</p><p data-pid="Gp0nZeY2">部分代码如下，代码文件：mnist_save.py</p><div class="highlight"><pre><code class="language-python3"><span class="kn">from</span> <span class="nn">torchvision.datasets</span> <span class="k">import</span> <span class="n">mnist</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="s1">'mnist'</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="s1">'mnist'</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">train_loader</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_loader</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">test_data</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code></pre></div><p data-pid="opGA5ldE">查看部分数据，进行可视化</p><div class="highlight"><pre><code class="language-text">def show():
    plt.figure(figsize=(16, 9))
    for i, item in enumerate(itertools.islice(train_loader,2,102)):
        plt.subplot(10, 10, i+1)
        img,label= item
        img = img[0].cpu().numpy()
        array = (img.reshape((28, 28)) * 255).astype(np.uint8)
        img = Image.fromarray(array, 'L')
        label = label.cpu().numpy()[0]
        plt.imshow(img, cmap=plt.get_cmap('gray'))
    plt.show()</code></pre></div><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-b73811052901fde356fcab190e023b86_b.jpg" data-size="normal" data-rawwidth="1166" data-rawheight="768" class="origin_image zh-lightbox-thumb" width="1166" data-original="https://pic3.zhimg.com/v2-b73811052901fde356fcab190e023b86_r.jpg"/></noscript><div><img src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-b73811052901fde356fcab190e023b86_720w.webp" data-size="normal" data-rawwidth="1166" data-rawheight="768" class="origin_image zh-lightbox-thumb lazy" width="1166" data-original="https://pic3.zhimg.com/v2-b73811052901fde356fcab190e023b86_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-b73811052901fde356fcab190e023b86_b.jpg" data-original-token="v2-2acf8be0cd5396c5dd4173d00c8876c4" height="768" data-lazy-status="ok"></div><figcaption>mnist可视化展示</figcaption></figure><p data-pid="A5z7Ncc6">这里需要将数据转化成图像格式，并保存下来，每个图像保存到各自对应的文件夹下，</p><div class="highlight"><pre><code class="language-text"># 将mnist保存为图像
def save():
    os.makedirs('mnist/train', exist_ok=True)
    os.makedirs('mnist/test', exist_ok=True)
    for i in range(10):
        os.makedirs('mnist/train/' + str(i), exist_ok=True)
        os.makedirs('mnist/test/' + str(i), exist_ok=True)
    # 保存训练集
    for i, item in enumerate(train_loader):
        img, label = item
        img = img[0].cpu().numpy()
        array = (img.reshape((28, 28)) * 255).astype(np.uint8)
        img = Image.fromarray(array, 'L')
        label = label.cpu().numpy()[0]
        img_path = 'mnist/train/' + str(label) + '/' + str(i) + '.jpg'
        print(img_path)
        img.save(img_path)</code></pre></div><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-4a4405e64f88f1c1ca47cd47e48cd919_b.jpg" data-size="normal" data-rawwidth="2210" data-rawheight="278" class="origin_image zh-lightbox-thumb" width="2210" data-original="https://pic2.zhimg.com/v2-4a4405e64f88f1c1ca47cd47e48cd919_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;2210&#39; height=&#39;278&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="2210" data-rawheight="278" class="origin_image zh-lightbox-thumb lazy" width="2210" data-original="https://pic2.zhimg.com/v2-4a4405e64f88f1c1ca47cd47e48cd919_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-4a4405e64f88f1c1ca47cd47e48cd919_b.jpg" data-original-token="v2-4a4405e64f88f1c1ca47cd47e48cd919"></div><figcaption>0-9文件夹</figcaption></figure><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-858f47236835767f0598cda8b260689a_b.jpg" data-size="normal" data-rawwidth="2388" data-rawheight="446" class="origin_image zh-lightbox-thumb" width="2388" data-original="https://pic3.zhimg.com/v2-858f47236835767f0598cda8b260689a_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;2388&#39; height=&#39;446&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="2388" data-rawheight="446" class="origin_image zh-lightbox-thumb lazy" width="2388" data-original="https://pic3.zhimg.com/v2-858f47236835767f0598cda8b260689a_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-858f47236835767f0598cda8b260689a_b.jpg" data-original-token="v2-d53814cd1d726d6cadf62ee13f46eb18"></div><figcaption>文件夹1内的数据</figcaption></figure><p data-pid="kQiXB1K0">我们数据下载来了，大部分情况下，pytorch自带的加载数据模块并不适用我们自己的数据，所以接下来需要需要重构加载数据模块，本文采用pytorch自带的datasets为基类，进行重构数据加载部分，需要继承torch.utils.data.Dataset类，自定义数据集时，需要覆盖两个方法：</p><ul><li data-pid="5FdvLfaJ">__len__:len(dataset) 数据集大小</li><li data-pid="xu9bOJiS">__getitem__:dataset[i] 第i个数据</li></ul><p data-pid="JDp537oP">代码文件：mnist_dataset.py</p><div class="highlight"><pre><code class="language-text"># 自定义数据读取
class MnistData(Dataset):
    def __init__(self, data, transform=None, target_transform=None):
        super(Dataset, self).__init__()
        self.transform = transform
        self.target_transform = target_transform
        self.samples = data

    def __len__(self):
        return len(self.samples)

    def __getitem__(self, index):
        img_path, target = self.samples[index]
        img = Image.open(img_path).convert('RGB')
        if self.transform is not None:
            img = self.transform(img)
        if self.target_transform is not None:
            target = self.target_transform(target)

        return img, target</code></pre></div><p data-pid="_ym3qY1f">数据加载部分完成。</p><h3 id="h_503280155_2" data-into-catalog-status="">二、网络模型</h3><p data-pid="Sg5AeWub">由于mnist的图像大小为28*28，如vgg、resnet等网络的入网尺寸较之太大，故不太适合mnist数据集，这里我们自定义实现一个简单的3层卷积神经网络，包含conv、bn、relu、pool等网络基本单元。</p><p data-pid="xQj3ncR5">网络结构图：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-60ccf701cfb32b53cf035d7b6e9bb648_b.jpg" data-size="normal" data-rawwidth="1366" data-rawheight="732" class="origin_image zh-lightbox-thumb" width="1366" data-original="https://pic1.zhimg.com/v2-60ccf701cfb32b53cf035d7b6e9bb648_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1366&#39; height=&#39;732&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="1366" data-rawheight="732" class="origin_image zh-lightbox-thumb lazy" width="1366" data-original="https://pic1.zhimg.com/v2-60ccf701cfb32b53cf035d7b6e9bb648_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-60ccf701cfb32b53cf035d7b6e9bb648_b.jpg" data-original-token="v2-9a3dfd66cf977a1cecf5cd456a066621"></div><figcaption>cnn结构（画图太糙）</figcaption></figure><p data-pid="02vPBffS">网络结构：本网络包含三个卷积部分，一个自适应池化和一个全连接层，其中每个卷积部分包含卷积、归一化、激活函数和池化，基本流程：</p><p data-pid="pfIoALpc">                input--&gt;conv1--&gt;conv2--&gt;conv3--&gt;advpool--&gt;fc</p><p data-pid="7VLoIR_I">卷积核池化计算公式：</p><p data-pid="PaVWPaWk">卷积：<a href="https://link.zhihu.com/?target=https%3A//pytorch.org/docs/stable/generated/torch.nn.Conv2d.html%23torch.nn.Conv2d" class=" wrap external" target="_blank" rel="nofollow noreferrer">Conv2d - PyTorch 1.11.0 documentation</a></p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-bb62b7a951efe7472ef40b8f20ea6e58_b.jpg" data-size="normal" data-rawwidth="789" data-rawheight="622" class="origin_image zh-lightbox-thumb" width="789" data-original="https://pic1.zhimg.com/v2-bb62b7a951efe7472ef40b8f20ea6e58_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;789&#39; height=&#39;622&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="789" data-rawheight="622" class="origin_image zh-lightbox-thumb lazy" width="789" data-original="https://pic1.zhimg.com/v2-bb62b7a951efe7472ef40b8f20ea6e58_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-bb62b7a951efe7472ef40b8f20ea6e58_b.jpg" data-original-token="v2-ae675b389b3eb168417fa1d668fcad04"></div><figcaption>卷积计算公式（来源官方文档）</figcaption></figure><p data-pid="Exge9s8s">池化：<a href="https://link.zhihu.com/?target=https%3A//pytorch.org/docs/stable/generated/torch.nn.MaxPool2d.html%23torch.nn.MaxPool2d" class=" wrap external" target="_blank" rel="nofollow noreferrer">MaxPool2d - PyTorch 1.11.0 documentation</a></p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-ae00097f3e65d5d3a546bf652d384b01_b.jpg" data-size="normal" data-rawwidth="795" data-rawheight="566" class="origin_image zh-lightbox-thumb" width="795" data-original="https://pic2.zhimg.com/v2-ae00097f3e65d5d3a546bf652d384b01_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;795&#39; height=&#39;566&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="795" data-rawheight="566" class="origin_image zh-lightbox-thumb lazy" width="795" data-original="https://pic2.zhimg.com/v2-ae00097f3e65d5d3a546bf652d384b01_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-ae00097f3e65d5d3a546bf652d384b01_b.jpg" data-original-token="v2-53e1fb35793a93f64ccedb5c158ce924"></div><figcaption>池化计算公式（来源官方文档）</figcaption></figure><p data-pid="s7bUuRRq">注意：卷积和池化默认是向下取整，其中池化可以通过ceil_mode=True设置为向上取整。</p><p data-pid="NiwpvXbc">数据流向和代码实现如下：CNN.py</p><div class="highlight"><pre><code class="language-text"># CNN分类网络
class CnnNet(nn.Module):
    def __init__(self, classes=10):
        super(CnnNet, self).__init__()
        # 分类数
        self.classes = classes
        # 第一层卷积，输入：bs*3*28*28 输出：bs*16*14*14
        self.conv1 = nn.Sequential(
            # 卷积 输入：bs*3*28*28  输出：bs*16*28*28
            nn.Conv2d(in_channels=3, out_channels=16, kernel_size=3, stride=1, padding=1),
            # 归一化
            nn.BatchNorm2d(16),
            # 激活函数
            nn.ReLU(),
            # 最大池化：输入:bs*16*28*28  输出：bs*16*14*14
            nn.MaxPool2d(2)
        )
        # 第二层卷积，输入：bs*16*14*14 输出：bs*64*7*7
        self.conv2 = nn.Sequential(
            # 卷积 输入：bs*16*14*14  输出：bs*32*14*14
            nn.Conv2d(in_channels=16, out_channels=32, kernel_size=3, stride=1, padding=1),
            # 归一化
            nn.BatchNorm2d(32),
            # 激活函数
            nn.ReLU(),
            # 最大池化：输入:bs*16*14*14  输出：bs*32*7*7
            nn.MaxPool2d(2)
        )
        # 第三层卷积，输入：bs*32*7*7 输出：bs*64*3*3
        self.conv3 = nn.Sequential(
            # 卷积 输入：bs*32*7*7  输出：bs*64*3*3
            nn.Conv2d(in_channels=32, out_channels=64, kernel_size=3, stride=1, padding=1),
            # 归一化
            nn.BatchNorm2d(64),
            # 激活函数
            nn.ReLU(),
            # 最大池化：输入：bs*32*7*7 输出：bs*64*3*3
            nn.MaxPool2d(2)
        )
        # 自适应池化，将bs*64*3*3映射为bs*64*1*1
        self.advpool = nn.AdaptiveAvgPool2d((1, 1))
        # 全连接层
        self.fc = nn.Linear(64, self.classes)

    def forward(self, x):
        x = self.conv1(x)
        x = self.conv2(x)
        x = self.conv3(x)
        x = self.advpool(x)
        # 需要将多维度的值展平为一维，送入linear中，但是需要保持batchsize的维度
        # 例如2*64*1*1 变成2*64
        out = x.view(x.size(0), -1)
        out = self.fc(out)
        return out</code></pre></div><p data-pid="3cYQXaOY">使用torchsummary查看网络结构、参数量、模型大小</p><div class="highlight"><pre><code class="language-text">    # 测试数据
    x = torch.rand((2, 3, 28, 28))
    cnn = CnnNet(classes=10)
    print(cnn)
    out = cnn(x)
    print(out)
    device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
    cnn = cnn.to(device)
    # 网络模型的数据流程及参数信息
    summary(cnn, (3, 28, 28))</code></pre></div><p data-pid="cafyNz6a">结果如下：</p><div class="highlight"><pre><code class="language-text">---------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1           [-1, 16, 28, 28]             448
       BatchNorm2d-2           [-1, 16, 28, 28]              32
              ReLU-3           [-1, 16, 28, 28]               0
         MaxPool2d-4           [-1, 16, 14, 14]               0
            Conv2d-5           [-1, 32, 14, 14]           4,640
       BatchNorm2d-6           [-1, 32, 14, 14]              64
              ReLU-7           [-1, 32, 14, 14]               0
         MaxPool2d-8             [-1, 32, 7, 7]               0
            Conv2d-9             [-1, 64, 7, 7]          18,496
      BatchNorm2d-10             [-1, 64, 7, 7]             128
             ReLU-11             [-1, 64, 7, 7]               0
        MaxPool2d-12             [-1, 64, 3, 3]               0
AdaptiveAvgPool2d-13             [-1, 64, 1, 1]               0
           Linear-14                   [-1, 10]             650
================================================================
Total params: 24,458
Trainable params: 24,458
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 0.01
Forward/backward pass size (MB): 0.54
Params size (MB): 0.09
Estimated Total Size (MB): 0.65
----------------------------------------------------------------</code></pre></div><h3 id="h_503280155_3" data-into-catalog-status="">三、训练部分</h3><p data-pid="UJzdLpN7">前两部分完成了数据处理和模型设计，本小节实现如何使用模型对mnist数据集进行识别训练</p><p data-pid="WDqHhqyo">首先设置超参数：</p><div class="highlight"><pre><code class="language-text">    # batchsize
    bs = 32
    # learning rate
    lr = 0.01
    # epoch
    epoch = 100</code></pre></div><p data-pid="zLxh4gJ8">然后加载训练集数据，并将数据划分为训练集和验证集</p><div class="highlight"><pre><code class="language-text"># 将数据集划分训练集和验证集
def split_data(files):
    """
    :param files:
    :return:
    """
    random.shuffle(files)
    # 计算比例系数，分割数据训练集和验证集
    ratio = 0.9
    offset = int(len(files) * ratio)
    train_data = files[:offset]
    val_data = files[offset:]
    return train_data, val_data</code></pre></div><p data-pid="8VxPQmxK">加载数据，使用自定数据处理MnistData类</p><div class="highlight"><pre><code class="language-text">    # 训练0-9的数据
    labels = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
    base_dir = '../mnist/train'
    imgs = []
    # 获取数据
    for label in labels:
        label_dir = os.path.join(base_dir, str(label))
        images = os.listdir(label_dir)
        for img in images:
            img_path = os.path.join(label_dir, img)
            imgs.append((img_path, label))
    print(len(imgs))
    # 将训练数据拆分成训练集和验证集
    trains, vals = split_data(imgs)
    # 加载训练集数据
    train_dataset = MnistData(trains, transform=transform)
    train_data = DataLoader(train_dataset, batch_size=bs, shuffle=True, num_workers=0)
    # 加载验证集数据
    val_dataset = MnistData(vals, transform=transform)
    val_data = DataLoader(val_dataset, batch_size=bs, shuffle=True, num_workers=0)</code></pre></div><p data-pid="SxXWEN2N">加载模型，设置损失函数交叉熵损失、优化器SGD</p><div class="highlight"><pre><code class="language-text">    # 加载模型
    model = CnnNet(classes=10)
    # GPU是否可用，如果可用，则使用GPU
    device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
    model.to(device)
    # 损失函数
    loss_func = nn.CrossEntropyLoss()
    # 优化器，使用SGD,可换Adam
    optimizer = torch.optim.SGD(model.parameters(), lr=lr, weight_decay=1e-3)</code></pre></div><p data-pid="zSvEO1Qt">训练&amp;输出训练日志&amp;保存best模型&amp;保存last模型</p><div class="highlight"><pre><code class="language-text"># 训练
def train(model, loss_func, optimizer, checkpoints, epoch):
    print('Train......................')
    # 记录每个epoch的loss和acc
    best_acc = 0
    best_epoch = 0
    # 训练过程
    for epoch in range(1, epoch):
        # 设置计时器，计算每个epoch的用时
        start_time = time.time()
        model.train()  # 保证每一个batch都能进入model.train()的模式
        # 记录每个epoch的loss和acc
        train_loss, train_acc, val_loss, val_acc = 0, 0, 0, 0
        for i, (inputs, labels) in enumerate(train_data):
            # print(batch_size)
            # print(i, inputs, labels)
            inputs = inputs.to(device)
            labels = labels.to(device)
            # 预测输出
            outputs = model(inputs)
            # 计算损失
            loss = loss_func(outputs, labels)
            # print(outputs)
            # 因为梯度是累加的，需要清零
            optimizer.zero_grad()
            # 反向传播
            loss.backward()
            # 优化器
            optimizer.step()
            # 计算准确率
            output = nn.functional.softmax(outputs, dim=1)
            pred = torch.argmax(output, dim=1)
            acc = torch.sum(pred == labels)
            train_loss += loss.item()
            train_acc += acc.item()
        # 验证集进行验证
        model.eval()
        with torch.no_grad():
            for i, (inputs, labels) in enumerate(val_data):
                inputs = inputs.to(device)
                labels = labels.to(device)
                # 预测输出
                outputs = model(inputs)
                # 计算损失
                loss = loss_func(outputs, labels)
                # 计算准确率
                output = nn.functional.softmax(outputs, dim=1)
                pred = torch.argmax(output, dim=1)
                # print(pred,'================')
                # print(pred==labels,'=====----------======')
                acc = torch.sum(pred == labels)
                # acc = calculat_acc(outputs, labels)
                val_loss += loss.item()
                val_acc += acc.item()

        # 计算每个epoch的训练损失和精度
        train_loss_epoch = train_loss / train_data_size
        train_acc_epoch = train_acc / train_data_size
        # 计算每个epoch的验证集损失和精度
        val_loss_epoch = val_loss / val_data_size
        val_acc_epoch = val_acc / val_data_size
        end_time = time.time()
        print(
            'epoch:{} | time:{:.4f} | train_loss:{:.4f} | train_acc:{:.4f} | eval_loss:{:.4f} | val_acc:{:.4f}'.format(
                epoch,
                end_time - start_time,
                train_loss_epoch,
                train_acc_epoch,
                val_loss_epoch,
                val_acc_epoch))

        # 记录验证集上准确率最高的模型
        best_model_path = checkpoints + "/" + 'best_model' + '.pth'
        if val_acc_epoch &gt;= best_acc:
            best_acc = val_acc_epoch
            best_epoch = epoch
            torch.save(model, best_model_path)
        print('Best Accuracy for Validation :{:.4f} at epoch {:d}'.format(best_acc, best_epoch))
        # 每迭代50次保存一次模型
        # if epoch % 50 == 0:
        #     model_name = '/epoch_' + str(epoch) + '.pt'
        #     torch.save(model, checkpoints + model_name)
    # 保存最后的模型
    torch.save(model, checkpoints + '/last.pt')</code></pre></div><p data-pid="MxM177fx">训练日志输出&amp;10个epoch能达到98.5%的准确率</p><div class="highlight"><pre><code class="language-text">Train......................
epoch:1 | time:80.9573 | train_loss:0.0238 | train_acc:0.8472 | eval_loss:0.0118 | val_acc:0.8898
Best Accuracy for Validation :0.8898 at epoch 1
epoch:2 | time:68.9780 | train_loss:0.0059 | train_acc:0.9597 | eval_loss:0.0044 | val_acc:0.9667
Best Accuracy for Validation :0.9667 at epoch 2
epoch:3 | time:59.8687 | train_loss:0.0038 | train_acc:0.9710 | eval_loss:0.0060 | val_acc:0.9463
Best Accuracy for Validation :0.9667 at epoch 2
epoch:4 | time:58.2875 | train_loss:0.0030 | train_acc:0.9769 | eval_loss:0.0026 | val_acc:0.9803
Best Accuracy for Validation :0.9803 at epoch 4
epoch:5 | time:77.2991 | train_loss:0.0026 | train_acc:0.9805 | eval_loss:0.0022 | val_acc:0.9828
Best Accuracy for Validation :0.9828 at epoch 5
epoch:6 | time:77.8352 | train_loss:0.0023 | train_acc:0.9827 | eval_loss:0.0020 | val_acc:0.9852
Best Accuracy for Validation :0.9852 at epoch 6
epoch:7 | time:76.7014 | train_loss:0.0021 | train_acc:0.9842 | eval_loss:0.0020 | val_acc:0.9837
Best Accuracy for Validation :0.9852 at epoch 6
epoch:8 | time:76.4207 | train_loss:0.0019 | train_acc:0.9854 | eval_loss:0.0021 | val_acc:0.9845
Best Accuracy for Validation :0.9852 at epoch 6
epoch:9 | time:76.3831 | train_loss:0.0017 | train_acc:0.9875 | eval_loss:0.0029 | val_acc:0.9765
Best Accuracy for Validation :0.9852 at epoch 6
epoch:10 | time:86.7663 | train_loss:0.0016 | train_acc:0.9878 | eval_loss:0.0026 | val_acc:0.9775
Best Accuracy for Validation :0.9852 at epoch 6
epoch:11 | time:88.5357 | train_loss:0.0015 | train_acc:0.9885 | eval_loss:0.0019 | val_acc:0.9842
Best Accuracy for Validation :0.9852 at epoch 6</code></pre></div><h3 id="h_503280155_4" data-into-catalog-status="">四、推理部分</h3><p data-pid="YtRx7CDW">完成了模型训练和模型保存，我们需要写一个推理程序来验证我们的模型是否能够具有识别mnist的能力，我看过很多博客，都忽略了推理预测模块的代码，本文从加载模型到预测结果详细的进行推理。</p><p data-pid="0gXMYRHC">加载模型：mnist_infer.py</p><div class="highlight"><pre><code class="language-text">   model_path = 'checkpoints/best_model.pth'
   # 加载模型
   self.model = torch.load(model_path)
   self.device = torch.device('gpu' if torch.cuda.is_available() else 'cpu')
   self.model = self.model.to(self.device)</code></pre></div><p data-pid="aQw8smoM">推理部分：</p><div class="highlight"><pre><code class="language-text">    # 预测
    def predict(self, img_path):
        transform = transforms.Compose([
            transforms.ToTensor()
        ])
        img = Image.open(img_path)
        img = img.convert('RGB')
        img = transform(img)
        img = img.view(1, 3, 28, 28).to(self.device)
        output = self.model(img)
        output = torch.softmax(output, dim=1)
        # 每个预测值的概率
        probability = output.cpu().detach().numpy()
        # 找出最大概率值的索引
        output = torch.argmax(output, dim=1)
        index = output.cpu().numpy()[0]
        # 预测结果
        pred = self.labels[index]
        print(pred, probability)
        return pred</code></pre></div><p data-pid="XCS58VMO">推理示例：</p><div class="highlight"><pre><code class="language-text">    img_path = '../mnist/test/1/12.jpg'
    pred = Pred()
    res = pred.predict(img_path)
    print(res)</code></pre></div><p data-pid="qcDGXr3a">推理结果为：1  概率为：0.993848</p><p data-pid="mYA_30kL">完结，文笔简陋，如有错误，请批评指出，谢谢！</p><p></p></div></div></div></div><div role="button" tabindex="0" class="ContentItem-time">发布于 2022-04-25 20:17</div><div class="Post-topicsAndReviewer"><div class="TopicList Post-Topics"><div class="Tag Topic css-ch8ocw" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;20073557&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/20073557" target="_blank"><div class="css-1gomreu">手写数字识别</div></a></span></div><div class="Tag Topic css-ch8ocw" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19813032&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19813032" target="_blank"><div class="css-1gomreu">深度学习（Deep Learning）</div></a></span></div><div class="Tag Topic css-ch8ocw" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;20043586&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/20043586" target="_blank"><div class="css-1gomreu">卷积神经网络（CNN）</div></a></span></div></div></div><div><div class="Sticky RichContent-actions is-fixed is-bottom" style="width: 690px; bottom: 0px; left: 506px;"><div class="ContentItem-actions" data-za-detail-view-path-module="BottomBar" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Post&quot;,&quot;id&quot;:&quot;503280155&quot;,&quot;token&quot;:&quot;503280155&quot;}}}"><span><button aria-label="赞同 26 " aria-live="polite" type="button" class="Button VoteButton VoteButton--up FEfUrdfMIKpQDJDqkjte"><span style="display:inline-flex;align-items:center">​<svg width="10" height="10" viewBox="0 0 24 24" class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor"><path fill-rule="evenodd" d="M13.792 3.681c-.781-1.406-2.803-1.406-3.584 0l-7.79 14.023c-.76 1.367.228 3.046 1.791 3.046h15.582c1.563 0 2.55-1.68 1.791-3.046l-7.79-14.023Z" clip-rule="evenodd"></path></svg></span>赞同 26</button><button aria-label="反对" aria-live="polite" type="button" class="Button VoteButton VoteButton--down FEfUrdfMIKpQDJDqkjte"><span style="display:inline-flex;align-items:center">​<svg width="10" height="10" viewBox="0 0 24 24" class="Zi Zi--TriangleDown" fill="currentColor"><path fill-rule="evenodd" d="M13.792 20.319c-.781 1.406-2.803 1.406-3.584 0L2.418 6.296c-.76-1.367.228-3.046 1.791-3.046h15.582c1.563 0 2.55 1.68 1.791 3.046l-7.79 14.023Z" clip-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button BottomActions-CommentBtn FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Comment Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>10 条评论</button><div class="Popover ShareMenu"><div class="ShareMenu-toggler" id="Popover2-toggle" aria-haspopup="true" aria-expanded="false"><button type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Share Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path d="M19.47 1.914a.8.8 0 0 1 1.204.778l-1.872 16.386a.9.9 0 0 1-1.204.743l-4.615-1.692a.7.7 0 0 0-.831.28l-1.927 3.02c-.43.674-1.474.369-1.474-.43v-3.865a.8.8 0 0 1 .179-.504l5.808-7.148a.595.595 0 0 0-.897-.781l-5.93 6.354a1.1 1.1 0 0 1-1.258.252L2.57 13.46a.8.8 0 0 1-.08-1.415l16.98-10.13Z"></path></svg></span>分享</button></div></div><button aria-live="polite" type="button" class="Button ContentItem-action FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Heart Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button><button type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Star Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path d="M10.484 3.307c.673-1.168 2.358-1.168 3.032 0l2.377 4.122a.25.25 0 0 0 .165.12l4.655.987c1.319.28 1.84 1.882.937 2.884l-3.186 3.535a.25.25 0 0 0-.063.193l.5 4.733c.142 1.34-1.222 2.33-2.453 1.782l-4.346-1.938a.25.25 0 0 0-.204 0l-4.346 1.938c-1.231.549-2.595-.442-2.453-1.782l.5-4.733a.25.25 0 0 0-.064-.193L2.35 11.42c-.903-1.002-.382-2.604.937-2.884l4.655-.987a.25.25 0 0 0 .164-.12l2.378-4.122Z"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Deliver Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><g fill-rule="evenodd" clip-rule="evenodd"><path d="M7.821 12a.75.75 0 0 1 .75-.75h6.857a.75.75 0 0 1 0 1.5H8.571a.75.75 0 0 1-.75-.75ZM8.965 8a.75.75 0 0 1 .75-.75h4.571a.75.75 0 0 1 0 1.5H9.715a.75.75 0 0 1-.75-.75Z"></path><path d="M7.527 3.15a2.35 2.35 0 0 0-2.309 1.91L3.165 15.84a.85.85 0 0 0-.015.16v2.5a2.35 2.35 0 0 0 2.35 2.35h13a2.35 2.35 0 0 0 2.35-2.35V16a.848.848 0 0 0-.015-.16L18.78 5.06a2.35 2.35 0 0 0-2.308-1.91H7.527Zm0 1.7a.65.65 0 0 0-.639.528l-1.88 9.872h13.984l-1.88-9.872a.65.65 0 0 0-.64-.528H7.528Z"></path></g></svg></span>申请转载</button><div class="Post-ActionMenuButton"><div class="Popover"><div id="Popover3-toggle" aria-haspopup="true" aria-expanded="false"><button type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--iconOnly fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY hIwDV_tcL6XN1HprrnAq"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Dots Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></span></button></div></div></div></div><div class="Post-SideActions" style="opacity: 1;"><button class="like"><div class="Post-SideActions-icon"><svg width="16" height="16" viewBox="0 0 24 24" class="Zi Zi--TriangleUp Post-SideActions-upIcon" fill="currentColor"><path fill-rule="evenodd" d="M13.792 3.681c-.781-1.406-2.803-1.406-3.584 0l-7.79 14.023c-.76 1.367.228 3.046 1.791 3.046h15.582c1.563 0 2.55-1.68 1.791-3.046l-7.79-14.023Z" clip-rule="evenodd"></path></svg></div><div class="likeCount"><div class="likeCount-inner" data-previous="已赞同 27">赞同 26</div></div></button><div class="Popover ShareMenu"><div class="ShareMenu-toggler" id="Popover9-toggle" aria-haspopup="true" aria-expanded="false"><button><div class="Post-SideActions-icon"><span style="display: inline-flex; align-items: center;">​<svg width="20" height="20" viewBox="0 0 24 24" class="Zi Zi--Share" fill="currentColor"><path d="M19.47 1.914a.8.8 0 0 1 1.204.778l-1.872 16.386a.9.9 0 0 1-1.204.743l-4.615-1.692a.7.7 0 0 0-.831.28l-1.927 3.02c-.43.674-1.474.369-1.474-.43v-3.865a.8.8 0 0 1 .179-.504l5.808-7.148a.595.595 0 0 0-.897-.781l-5.93 6.354a1.1 1.1 0 0 1-1.258.252L2.57 13.46a.8.8 0 0 1-.08-1.415l16.98-10.13Z"></path></svg></span></div>分享</button></div></div></div></div><div class="Sticky--holder" style="position: static; inset: auto auto 0px 0px; display: block; float: none; margin: 0px 0px 10px; height: 54px;"></div></div></article><div class="Post-Sub Post-NormalSub"><div style="overflow: unset;" data-za-detail-view-path-module="CommentList" data-za-extra-module="{}"><div class="Comments-container css-plbgu"><div class="css-79elbk"><div><div class="css-1fo89v5"><img class="Avatar css-m4psdq" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg" srcset="https://pic1.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=32738c0c 2x"><div class="css-14zbeoe"><div class="css-i6bazn"><div class="css-0"><div class="InputLike css-1rl4wxv Editable"><div class="Dropzone Editable-content RichText RichText--editable RichText--clearBoth ztext" style="min-height: 38px;"><div class="DraftEditor-root"><div class="public-DraftEditorPlaceholder-root"><div class="public-DraftEditorPlaceholder-inner" id="placeholder-f8tvo" style="white-space: pre-wrap;">欢迎参与讨论</div></div><div class="DraftEditor-editorContainer"><div aria-describedby="placeholder-f8tvo" class="notranslate public-DraftEditor-content" contenteditable="true" spellcheck="true" tabindex="0" style="outline: none; user-select: text; white-space: pre-wrap; overflow-wrap: break-word;" role="textbox"><div data-contents="true"><div class="Editable-unstyled" data-block="true" data-editor="f8tvo" data-offset-key="fvevh-0-0"><div data-offset-key="fvevh-0-0" class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr"><span data-offset-key="fvevh-0-0"><br data-text="true"></span></div></div></div></div></div></div></div><div></div><input multiple="" type="file" accept="image/webp,image/jpg,image/jpeg,image/png,image/gif" style="display: none;"></div></div></div></div></div></div><div class="css-u76jt1"><div class="css-hzocic"><div class="css-r4op92"><div class="css-1k10w8f">10 条评论</div></div><div class="css-59erns"></div><div class="css-97fdvh"><div class="css-m0zh86">默认</div><div class="css-1fjr6cy">最新</div></div></div><div class="css-840pn3"><div class="css-18ld3w0"><div data-id="10268165971"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/cedf265a2d2957c0e330b4fef03e0f9e" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-3ac91e92b055c6acd28a8a4db8ae0cf0_l.jpg" srcset="https://pic1.zhimg.com/v2-3ac91e92b055c6acd28a8a4db8ae0cf0_l.jpg?source=06d4cd63 2x" alt="胖胖的小胖子" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/cedf265a2d2957c0e330b4fef03e0f9e" target="_blank" class="css-10u695f">胖胖的小胖子</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt">有个小小的疑问，卷积层的输入通道是3输出通道是10，多出的这7个通道数里面的值是哪里来的呢，希望大佬能解答一下<img src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-41f74f3795489083630fa29fde6c1c4d.png" class="sticker" alt="[大哭]"></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2022-08-28</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>2</button></div></div></div></div><div data-id="10719778142"><div class="css-1kwt8l8"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/4362b1257f287558d168a08ee4044d41" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-b5bdfef3bb2b2ef9c1f4c9bd4d045a09_l.jpg" srcset="https://pica.zhimg.com/v2-b5bdfef3bb2b2ef9c1f4c9bd4d045a09_l.jpg?source=06d4cd63 2x" alt="hyamyname" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/4362b1257f287558d168a08ee4044d41" target="_blank" class="css-10u695f">hyamyname</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><img src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-4812630bc27d642f7cafcd6cdeca3d7a.jpg" class="css-1pj8qrb"></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>用了10个卷积核吧</p><p></p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2023-11-03</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div></div></div><div data-id="10779021054"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/9bb3c1b0f331650c86bd387342706d13" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-d335670af5e9a192edf16e83f6734bb1_l.jpg" srcset="https://picx.zhimg.com/v2-d335670af5e9a192edf16e83f6734bb1_l.jpg?source=06d4cd63 2x" alt="我是一片叶" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/9bb3c1b0f331650c86bd387342706d13" target="_blank" class="css-10u695f">我是一片叶</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>但是目前这样的模型智能用在这种mnist数据集上，怎么让它具有使用价值呢，就是在一大张图片上，多个位置有大小不一的数字，分别把他们识别出来</p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">01-17</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div><div data-id="10827613907"><div class="css-1kwt8l8"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/e8ee2334d249cd097f6bfd7d9042d5ee" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-7e8a664d6eaebdd351fced054cee2f6b_l(1).jpg" srcset="https://pic1.zhimg.com/v2-7e8a664d6eaebdd351fced054cee2f6b_l.jpg?source=06d4cd63 2x" alt="张云飞" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/e8ee2334d249cd097f6bfd7d9042d5ee" target="_blank" class="css-10u695f">张云飞</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-8v0dsd" href="">作者</span></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt">这个很简单啊，目标检测，ocr都是可以的</div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">03-15</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div></div><div data-id="10823676454"><div class="css-1kwt8l8"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/4ae17442f75a4961a85e7acbef1da5ac" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-0be631db749f7f5b0b01db08d76b053e_l.jpg" srcset="https://pic1.zhimg.com/v2-0be631db749f7f5b0b01db08d76b053e_l.jpg?source=06d4cd63 2x" alt="伊藤豪" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/4ae17442f75a4961a85e7acbef1da5ac" target="_blank" class="css-10u695f">伊藤豪</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>对大图进行预处理，切分出不同的子图，对子图进行识别</p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">03-11</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div></div></div><div data-id="10326766843"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/016373f7bd705d846569ac0bbd1f9766" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-4d33ebdc4b785187af2e8f1ebb7a7720_l.jpg" srcset="https://pic1.zhimg.com/v2-4d33ebdc4b785187af2e8f1ebb7a7720_l.jpg?source=06d4cd63 2x" alt="摸鱼的猪猪" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/016373f7bd705d846569ac0bbd1f9766" target="_blank" class="css-10u695f">摸鱼的猪猪</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p><img src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-0942128ebfe78f000e84339fbb745611.png" class="sticker" alt="[爱]"></p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2022-10-20</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div></div><div data-id="10272448777"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/7fd6bbbea192751cc223fbbe7cccc472" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-24d5be2942a25854e321f83d639e0ac8_l.jpg" srcset="https://picx.zhimg.com/v2-24d5be2942a25854e321f83d639e0ac8_l.jpg?source=06d4cd63 2x" alt="神经蛙" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/7fd6bbbea192751cc223fbbe7cccc472" target="_blank" class="css-10u695f">神经蛙</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><img src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-4812630bc27d642f7cafcd6cdeca3d7a.jpg" class="css-1pj8qrb"></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>飞飞牛</p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2022-09-02</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div></div><div data-id="10215724241"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/29c328cd0154082dcec6074bcebf305f" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-bf6d04cd8db179d474697d7532011d62_l.jpg" srcset="https://pic1.zhimg.com/v2-bf6d04cd8db179d474697d7532011d62_l.jpg?source=06d4cd63 2x" alt="042357" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/29c328cd0154082dcec6074bcebf305f" target="_blank" class="css-10u695f">042357</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>看完了，觉得更牛逼了<img src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-0942128ebfe78f000e84339fbb745611.png" class="sticker" alt="[爱]"></p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2022-07-14</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div></div><div data-id="10213283623"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/29c328cd0154082dcec6074bcebf305f" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-bf6d04cd8db179d474697d7532011d62_l(1).jpg" srcset="https://picx.zhimg.com/v2-bf6d04cd8db179d474697d7532011d62_l.jpg?source=06d4cd63 2x" alt="042357" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/29c328cd0154082dcec6074bcebf305f" target="_blank" class="css-10u695f">042357</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt"><p>牛逼<img src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-c96dd18b15beb196b2daba95d26d9b1c.png" class="sticker" alt="[酷]"></p></div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2022-07-12</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div></div><div data-id="10132415592"><div class="css-jp43l4"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/bf966b8927539c6304331bf5524a9473" target="_blank" class="css-1dxejhk"><img class="Avatar css-1ljippv" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-abed1a8c04700ba7d72b45195223e0ff_l(1).jpg" srcset="https://pica.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=06d4cd63 2x" alt="小菜鸟" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-z0cc58"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/bf966b8927539c6304331bf5524a9473" target="_blank" class="css-10u695f">小菜鸟</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><img src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-4812630bc27d642f7cafcd6cdeca3d7a(1).jpg" class="css-1pj8qrb"></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></div><div class="CommentContent css-1jpzztt">牛逼</div><div class="css-140jo2"><div class="css-1a5a57m"><div class="css-x1xlu5"><span class="css-12cl38p">2022-04-25</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1ij6qqc"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-1vd72tl" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--HeartFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button></div></div></div></div></div><div></div></div></div></div></div></div></div><div role="complementary" aria-label="推荐阅读" class="Recommendations-Main" style="width: 1702px;"><h3 class="BlockTitle Recommendations-BlockTitle">推荐阅读</h3><ul class="Recommendations-List"><button class="PagingButton PagingButton-Previous" disabled="" data-za-detail-view-path-module="Unknown" data-za-detail-view-path-module_name="推荐阅读" data-za-extra-module="{}"><svg width="40" height="40" viewBox="0 0 24 24" fill="#d3d3d3" class="Zi Zi--ArrowLeft"><path fill-rule="evenodd" d="M14.609 6.322c.349.335.36.889.026 1.237l-4.253 4.438 4.254 4.444a.875.875 0 1 1-1.264 1.21l-4.834-5.05a.875.875 0 0 1 0-1.21l4.834-5.043a.875.875 0 0 1 1.237-.026Z" clip-rule="evenodd"></path></svg></button><a href="https://zhuanlan.zhihu.com/p/350111566" class="PostItem"><div><img src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-2e6836e4dc25531a606bf52fa76780f7_250x0.jpg" srcset="https://pic1.zhimg.com/v2-2e6836e4dc25531a606bf52fa76780f7_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="PyTorch实现MNIST手写数字识别/LeNet/tensorboard绘制loss曲线"><h1 class="PostItem-Title">PyTorch实现MNIST手写数字识别/LeNet/tensorboard绘制loss曲线</h1><div class="PostItem-Footer"><span>nin修炼中</span><span class="PostItem-FooterTitle"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/445381875" class="PostItem"><div><img src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-b9445bd39f0256726bf87925c2734932_250x0.jpg" srcset="https://pic1.zhimg.com/v2-b9445bd39f0256726bf87925c2734932_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="手把手教你用pytorch实现手写数字识别"><h1 class="PostItem-Title">手把手教你用pytorch实现手写数字识别</h1><div class="PostItem-Footer"><span>奔跑的小蜗牛RLS</span><span class="PostItem-FooterTitle"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/137571225" class="PostItem"><div><img src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-5adaeac34b19be4258cc21b476aaf39f_250x0.jpg" srcset="https://picx.zhimg.com/v2-5adaeac34b19be4258cc21b476aaf39f_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="用PyTorch实现MNIST手写数字识别(非常详细)"><h1 class="PostItem-Title">用PyTorch实现MNIST手写数字识别(非常详细)</h1><div class="PostItem-Footer"><span>小锋学长</span><span class="PostItem-FooterTitle"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/307834814" class="PostItem"><div><img src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/v2-70fc9334144800f0f1fb0c18eefafdcf_250x0.jpg" srcset="https://picx.zhimg.com/v2-70fc9334144800f0f1fb0c18eefafdcf_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="pytorch 实现MNIST手写数字识别"><h1 class="PostItem-Title">pytorch 实现MNIST手写数字识别</h1><div class="PostItem-Footer"><span>张欣In</span><span class="PostItem-FooterTitle"></span></div></div></a><button class="PagingButton PagingButton-Next" data-za-detail-view-path-module="Unknown" data-za-detail-view-path-module_name="推荐阅读" data-za-extra-module="{}"><svg width="40" height="40" viewBox="0 0 24 24" fill="#d3d3d3" class="Zi Zi--ArrowRight"><path fill-rule="evenodd" d="M10.518 6.224a.875.875 0 0 1 1.212.248l3.335 5.05a.875.875 0 0 1 0 .964l-3.334 5.043a.875.875 0 0 1-1.46-.965l3.015-4.56-3.016-4.568a.875.875 0 0 1 .248-1.212Z" clip-rule="evenodd"></path></svg></button></ul></div></div></div></main><div role="complementary"><div class="CornerButtons"><div class="CornerAnimayedFlex CornerAnimayedFlex--hidden"><button data-tooltip="回到顶部" data-tooltip-position="left" data-tooltip-will-hide-on-click="true" aria-label="回到顶部" type="button" class="Button CornerButton Button--plain css-4lspwd"><svg width="24" height="24" viewBox="0 0 24 24" aria-hidden="true" class="Zi Zi--BackToTop" fill="currentColor"><path fill-rule="evenodd" d="M13.204 3.107a1.75 1.75 0 0 0-2.408 0L3.806 9.73c-1.148 1.088-.378 3.02 1.204 3.02h2.24V20c0 .966.784 1.75 1.75 1.75h6A1.75 1.75 0 0 0 16.75 20v-7.25h2.24c1.582 0 2.353-1.932 1.204-3.02l-6.99-6.623Z" clip-rule="evenodd"></path></svg></button></div></div></div></div></div><script id="js-clientConfig" type="text/json">{"fetchRoot":{"www":"https:\u002F\u002Fwww.zhihu.com","api":"https:\u002F\u002Fapi.zhihu.com","lens":"https:\u002F\u002Flens.zhihu.com","zhuanlan":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fapi\u002F","walletpay":"https:\u002F\u002Fwalletpay.zhihu.com","captcha":"https:\u002F\u002Fcaptcha.zhihu.com","vzuu":"https:\u002F\u002Fv.vzuu.com","openapi":"https:\u002F\u002Fopenapi.zhihu.com","svip":"https:\u002F\u002Fsvip.zhihu.com"},"host":"zhihu.com","protocol":"https:","wwwHost":"www.zhihu.com","videoHost":"video.zhihu.com","zhuanlanHost":"zhuanlan.zhihu.com","allowSignUp":true,"refreshValidityPeriod":"30","release":"1357-9b898476","currentEntry":"column","isMobileEntry":false,"apollo":{"env":"prod","globalSilence":"","ncgModeSign":"3f8e56febda4fb3bbea72e379d76de1e","topstory_rec_adp":"1","topstory_hot_adp":"1","editor_adapt_native":"0","editor_auto_rotate":"0","enable_request_filter":"1","content_publish_pin":"0","content_publish_answer":"1","content_publish_question":"1","content_publish_article":"1","content_publish_zvideo":"1","balanceModalSign":"ChYHAcB5ihJECkAFnhDAYmdhsTWVJoNc","reportBackendPublishError":"1","test_canary":"member|0-100,1-0","use_new_player":"member|0-100,1-0","player_vendor":"member|0-100,1-0,2-0","use_hevc":"member|0-0,1-100","upload_use_signature":"member|0-0,1-100","use_backdrop_blur":"member|0-0,1-100","article_title_imagex":"member|0-0,1-100","play_station":"member|0-0,1-100","use_cached_supported_countries":"device|1-100,0-0","contentItem_cover_imagex":"member|0-0,1-100","use_qrcode_login_v2":"device|1-100,0-0"}}</script><script id="js-initialData" type="text/json">{"initialState":{"common":{"ask":{},"cities":{"cityData":[]}},"loading":{"global":{"count":0},"local":{"env\u002FgetIpinfo\u002F":false,"article\u002Fget\u002F":false,"brand\u002FgetUrl\u002F":false,"article\u002FloadPostSearchEntity\u002F":false}},"entities":{"users":{"c29982ea4958b35f1d733b99ef5bf579":{"uid":1454038455692562400,"userType":"people","id":"c29982ea4958b35f1d733b99ef5bf579"},"zhang-yun-fei-15-29":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-7e8a664d6eaebdd351fced054cee2f6b.jpg?source=172ae18b","uid":"739864926201335808","userType":"people","isFollowing":false,"urlToken":"zhang-yun-fei-15-29","id":"e8ee2334d249cd097f6bfd7d9042d5ee","description":"旧时邮票很贵，一封信寄走我对你的思念，你离我很近。今日网络发达，一条“在吗？”却隔断你我，往事只剩寒暄，你我相隔更远！","name":"张云飞","isAdvertiser":false,"headline":"君子慎独卑以自牧","gender":1,"url":"\u002Fpeople\u002Fe8ee2334d249cd097f6bfd7d9042d5ee","avatarUrl":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-7e8a664d6eaebdd351fced054cee2f6b_l.jpg?source=172ae18b","isOrg":false,"type":"people","badge":[],"badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""},"exposedMedal":{"medalId":"972460827463282688","medalName":"表示赞同","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-c38ebd5a7d1f43a5ed9ac0411a3e233a_r.png?source=172ae18b","miniAvatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-c38ebd5a7d1f43a5ed9ac0411a3e233a_l.png?source=172ae18b","description":"赞同 5 次","medalAvatarFrame":""}}},"questions":{},"answers":{},"articles":{"503280155":{"trackUrl":["https:\u002F\u002Fsugar.zhihu.com\u002Fplutus_adreaper\u002Fcontent_monitor_log?si=__SESSIONID__&ti=__ATOKEN__&at=view&pf=__OS__&ed=BiBUKF0xBSkqGGpfBWh6CVx3AAGOF_uGOiPJ&idfa=__IDFA__&imei=__IMEI__&androidid=__ANDROIDID__&oaid=__OAID__&ci=__CREATIVEID__&zid=__ZONEID__"],"entityWords":[{"name":"train_acc","mention":"train_acc","matchorder":12,"begin":16889,"end":16898,"entityid":3881535669137776600,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Psychology","score":0.0015649889272464912,"attachedInfoBytes":"sgJhCgl0cmFpbl9hY2MSClBzeWNob2xvZ3kY+YMBIIKEASgMNVEgzTo6B2FydGljbGVAvb\u002Fcr4OE\u002F+41SABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMvICzQEKJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMhoHYXJ0aWNsZSIJMTk5OTcxODk2Ogl0cmFpbl9hY2NAvb\u002Fcr4OE\u002F+41SABSEmFpX2VudGl0eV9yZWNhbGxlcl1RIM06YmEKCXRyYWluX2FjYxIKUHN5Y2hvbG9neRj5gwEggoQBKAw1USDNOjoHYXJ0aWNsZUC9v9yvg4T\u002F7jVIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"交叉熵损失","mention":"交叉熵损失","matchorder":1,"begin":15961,"end":15966,"entityid":-266027184936526000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Computer","score":0.0011738316327933318,"attachedInfoBytes":"sgJkCg\u002FkuqTlj4nnhrXmjZ\u002FlpLESCENvbXB1dGVyGNl8IN58KAE1QduZOjoHYXJ0aWNsZUDHvovq9LW4p\u002FwBSABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMvIC1wEKJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMhoHYXJ0aWNsZSIJMTk5OTcxODk2Og\u002FkuqTlj4nnhrXmjZ\u002FlpLFAx76L6vS1uKf8AUgBUhJhaV9lbnRpdHlfcmVjYWxsZXJdQduZOmJkCg\u002FkuqTlj4nnhrXmjZ\u002FlpLESCENvbXB1dGVyGNl8IN58KAE1QduZOjoHYXJ0aWNsZUDHvovq9LW4p\u002FwBSABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMg==","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"best_epoch","mention":"best_epoch","matchorder":2,"begin":16662,"end":16672,"entityid":-8662075401493650000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0.0009425958391498512,"attachedInfoBytes":"sgJgCgpiZXN0X2Vwb2NoEgdNZWRpY2FsGJaCASCgggEoAjWJGHc6OgdhcnRpY2xlQL7EyaKOiojlhwFIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy8gLOAQokNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUyGgdhcnRpY2xlIgkxOTk5NzE4OTY6CmJlc3RfZXBvY2hAvsTJoo6KiOWHAUgCUhJhaV9lbnRpdHlfcmVjYWxsZXJdiRh3OmJgCgpiZXN0X2Vwb2NoEgdNZWRpY2FsGJaCASCgggEoAjWJGHc6OgdhcnRpY2xlQL7EyaKOiojlhwFIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"激活函数","mention":"激活函数","matchorder":4,"begin":8867,"end":8871,"entityid":-542207717370342660,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0.0005703966536482336,"attachedInfoBytes":"sgJiCgzmv4DmtLvlh73mlbASCU90aGVyVGVybRijRSCnRSgENayGFTo6B2FydGljbGVA6aWp3cKe7Lz4AUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTLyAtIBCiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTIaB2FydGljbGUiCTE5OTk3MTg5NjoM5r+A5rS75Ye95pWwQOmlqd3Cnuy8+AFIA1ISYWlfZW50aXR5X3JlY2FsbGVyXayGFTpiYgoM5r+A5rS75Ye95pWwEglPdGhlclRlcm0Yo0Ugp0UoBDWshhU6OgdhcnRpY2xlQOmlqd3Cnuy8+AFIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"torch.sum","mention":"torch.sum","matchorder":1,"begin":17587,"end":17596,"entityid":2702039069307719000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0.0015262200344753896,"attachedInfoBytes":"sgJeCgl0b3JjaC5zdW0SB01lZGljYWwYs4kBILyJASgBNXILyDo6B2FydGljbGVA+ZvB+vrG5L8lSABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMvICygEKJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMhoHYXJ0aWNsZSIJMTk5OTcxODk2Ogl0b3JjaC5zdW1A+ZvB+vrG5L8lSARSEmFpX2VudGl0eV9yZWNhbGxlcl1yC8g6Yl4KCXRvcmNoLnN1bRIHTWVkaWNhbBiziQEgvIkBKAE1cgvIOjoHYXJ0aWNsZUD5m8H6+sbkvyVIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"自适应池化","mention":"自适应池化","matchorder":2,"begin":8837,"end":8842,"entityid":-3739034616190957000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0.0012554006734520062,"attachedInfoBytes":"sgJlCg\u002Foh6rpgILlupTmsaDljJYSCU90aGVyVGVybRiFRSCKRSgCNUKMpDo6B2FydGljbGVAqJSy2Lr6kY7MAUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTLyAtgBCiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTIaB2FydGljbGUiCTE5OTk3MTg5NjoP6Ieq6YCC5bqU5rGg5YyWQKiUsti6+pGOzAFIBVISYWlfZW50aXR5X3JlY2FsbGVyXUKMpDpiZQoP6Ieq6YCC5bqU5rGg5YyWEglPdGhlclRlcm0YhUUgikUoAjVCjKQ6OgdhcnRpY2xlQKiUsti6+pGOzAFIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"calculat_acc","mention":"calculat_acc","matchorder":1,"begin":18375,"end":18387,"entityid":2286181243207002400,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0010904289829133662,"attachedInfoBytes":"sgJeCgxjYWxjdWxhdF9hY2MSBE1hdGgYx48BINOPASgBNbrsjjo6B2FydGljbGVA3dGO7KW3id0fSABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMvICzQEKJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMhoHYXJ0aWNsZSIJMTk5OTcxODk2OgxjYWxjdWxhdF9hY2NA3dGO7KW3id0fSAZSEmFpX2VudGl0eV9yZWNhbGxlcl267I46Yl4KDGNhbGN1bGF0X2FjYxIETWF0aBjHjwEg048BKAE1uuyOOjoHYXJ0aWNsZUDd0Y7spbeJ3R9IAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"train_loss","mention":"train_loss","matchorder":8,"begin":16877,"end":16887,"entityid":3662619218255664000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0.0008728521583299537,"attachedInfoBytes":"sgJfCgp0cmFpbl9sb3NzEgdNZWRpY2FsGO2DASD3gwEoCDUe0GQ6OgdhcnRpY2xlQManl93gmI\u002FqMkgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTLyAswBCiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTIaB2FydGljbGUiCTE5OTk3MTg5NjoKdHJhaW5fbG9zc0DGp5fd4JiP6jJIB1ISYWlfZW50aXR5X3JlY2FsbGVyXR7QZDpiXwoKdHJhaW5fbG9zcxIHTWVkaWNhbBjtgwEg94MBKAg1HtBkOjoHYXJ0aWNsZUDGp5fd4JiP6jJIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"base_dir","mention":"base_dir","matchorder":1,"begin":15216,"end":15224,"entityid":4620997796250257000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0006112649509411733,"attachedInfoBytes":"sgJYCghiYXNlX2RpchIETWF0aBjwdiD4digBNUw9IDo6B2FydGljbGVA6JLwyrOgxZBASABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMvICwwEKJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMhoHYXJ0aWNsZSIJMTk5OTcxODk2OghiYXNlX2RpckDokvDKs6DFkEBICFISYWlfZW50aXR5X3JlY2FsbGVyXUw9IDpiWAoIYmFzZV9kaXISBE1hdGgY8HYg+HYoATVMPSA6OgdhcnRpY2xlQOiS8MqzoMWQQEgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTI=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"mnist数据集","mention":"mnist数据集","matchorder":1,"begin":8298,"end":8306,"entityid":6671550228476766000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Commodity","score":0.0016642828143195731,"attachedInfoBytes":"sgJjCg5tbmlzdOaVsOaNrumbhhIJQ29tbW9kaXR5GOpAIPJAKAE1ESTaOjoHYXJ0aWNsZUCN0KLs3fKGy1xIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy8gLUAQokNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUyGgdhcnRpY2xlIgkxOTk5NzE4OTY6Dm1uaXN05pWw5o2u6ZuGQI3Qouzd8obLXEgJUhJhaV9lbnRpdHlfcmVjYWxsZXJdESTaOmJjCg5tbmlzdOaVsOaNrumbhhIJQ29tbW9kaXR5GOpAIPJAKAE1ESTaOjoHYXJ0aWNsZUCN0KLs3fKGy1xIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"target_transform","mention":"target_transform","matchorder":5,"begin":7583,"end":7599,"entityid":1195929690370644200,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0009376791353039871,"attachedInfoBytes":"sgJgChB0YXJnZXRfdHJhbnNmb3JtEgRNYXRoGJ87IK87KAU1lc51OjoHYXJ0aWNsZUC6sYqX+fayzBBIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy8gLTAQokNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUyGgdhcnRpY2xlIgkxOTk5NzE4OTY6EHRhcmdldF90cmFuc2Zvcm1AurGKl\u002Fn2sswQSApSEmFpX2VudGl0eV9yZWNhbGxlcl2VznU6YmAKEHRhcmdldF90cmFuc2Zvcm0SBE1hdGgYnzsgrzsoBTWVznU6OgdhcnRpY2xlQLqxipf59rLMEEgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTI=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"mnist_dataset","mention":"mnist_dataset","matchorder":1,"begin":7426,"end":7439,"entityid":-2381263976238695000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0009067493698633466,"attachedInfoBytes":"sgJeCg1tbmlzdF9kYXRhc2V0EgRNYXRoGII6II86KAE17LJtOjoHYXJ0aWNsZUC3+u6e+6CD+t4BSABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMvICzwEKJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMhoHYXJ0aWNsZSIJMTk5OTcxODk2Og1tbmlzdF9kYXRhc2V0QLf67p77oIP63gFIC1ISYWlfZW50aXR5X3JlY2FsbGVyXeyybTpiXgoNbW5pc3RfZGF0YXNldBIETWF0aBiCOiCPOigBNeyybTo6B2FydGljbGVAt\u002Frunvugg\u002FreAUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTI=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"全连接层","mention":"全连接层","matchorder":2,"begin":8845,"end":8849,"entityid":-8949524726085361000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Computer","score":0.0008423875074483056,"attachedInfoBytes":"sgJhCgzlhajov57mjqXlsYISCENvbXB1dGVyGI1FIJFFKAI1q9NcOjoHYXJ0aWNsZUDEyu2I2tW55oMBSABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMvIC0QEKJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMhoHYXJ0aWNsZSIJMTk5OTcxODk2Ogzlhajov57mjqXlsYJAxMrtiNrVueaDAUgMUhJhaV9lbnRpdHlfcmVjYWxsZXJdq9NcOmJhCgzlhajov57mjqXlsYISCENvbXB1dGVyGI1FIJFFKAI1q9NcOjoHYXJ0aWNsZUDEyu2I2tW55oMBSABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMg==","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"num_workers=0","mention":"num_workers=0","matchorder":2,"begin":15742,"end":15755,"entityid":-781636385317152000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0006998938846661112,"attachedInfoBytes":"sgJeCg1udW1fd29ya2Vycz0wEgRNYXRoGP56IIt7KAI1FXk3OjoHYXJ0aWNsZUDmtZrtlLvEk\u002FUBSABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMvICzwEKJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMhoHYXJ0aWNsZSIJMTk5OTcxODk2Og1udW1fd29ya2Vycz0wQOa1mu2Uu8ST9QFIDVISYWlfZW50aXR5X3JlY2FsbGVyXRV5NzpiXgoNbnVtX3dvcmtlcnM9MBIETWF0aBj+eiCLeygCNRV5Nzo6B2FydGljbGVA5rWa7ZS7xJP1AUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTI=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"epoch epoch","mention":"epoch epoch","matchorder":1,"begin":5756,"end":5767,"entityid":-1700462213094114600,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0.0006925848543108959,"attachedInfoBytes":"sgJfCgtlcG9jaCBlcG9jaBIHTWVkaWNhbBj8LCCHLSgBNZWONTo6B2FydGljbGVAx\u002FWz1IbUr7PoAUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTLyAs4BCiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTIaB2FydGljbGUiCTE5OTk3MTg5NjoLZXBvY2ggZXBvY2hAx\u002FWz1IbUr7PoAUgOUhJhaV9lbnRpdHlfcmVjYWxsZXJdlY41OmJfCgtlcG9jaCBlcG9jaBIHTWVkaWNhbBj8LCCHLSgBNZWONTo6B2FydGljbGVAx\u002FWz1IbUr7PoAUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTI=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"torchsummary","mention":"torchsummary","matchorder":1,"begin":12362,"end":12374,"entityid":-1268315397947168800,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Commodity","score":0.003181873057575557,"attachedInfoBytes":"sgJiCgx0b3JjaHN1bW1hcnkSCUNvbW1vZGl0eRjKYCDWYCgBNfmGUDs6B2FydGljbGVAm8\u002FN0di7grPuAUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTLyAtIBCiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTIaB2FydGljbGUiCTE5OTk3MTg5NjoMdG9yY2hzdW1tYXJ5QJvPzdHYu4Kz7gFID1ISYWlfZW50aXR5X3JlY2FsbGVyXfmGUDtiYgoMdG9yY2hzdW1tYXJ5EglDb21tb2RpdHkYymAg1mAoATX5hlA7OgdhcnRpY2xlQJvPzdHYu4Kz7gFIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"pytorch复现","mention":"pytorch复现","matchorder":1,"begin":977,"end":986,"entityid":-5499837500487237000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0021433059560179712,"attachedInfoBytes":"sgJeCg1weXRvcmNo5aSN546wEgRNYXRoGNEHINoHKAE1tXYMOzoHYXJ0aWNsZUDNiNio7N2p1rMBSABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMvICzwEKJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMhoHYXJ0aWNsZSIJMTk5OTcxODk2Og1weXRvcmNo5aSN546wQM2I2Kjs3anWswFIEFISYWlfZW50aXR5X3JlY2FsbGVyXbV2DDtiXgoNcHl0b3JjaOWkjeeOsBIETWF0aBjRByDaBygBNbV2DDs6B2FydGljbGVAzYjYqOzdqdazAUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTI=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"batch_size=1","mention":"batch_size=1","matchorder":2,"begin":999,"end":1011,"entityid":369755588806954900,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.000939214845527031,"attachedInfoBytes":"sgJcCgxiYXRjaF9zaXplPTESBE1hdGgY5wcg8wcoAjWkNXY6OgdhcnRpY2xlQIaft+T71+iQBUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTLyAssBCiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTIaB2FydGljbGUiCTE5OTk3MTg5NjoMYmF0Y2hfc2l6ZT0xQIaft+T71+iQBUgRUhJhaV9lbnRpdHlfcmVjYWxsZXJdpDV2OmJcCgxiYXRjaF9zaXplPTESBE1hdGgY5wcg8wcoAjWkNXY6OgdhcnRpY2xlQIaft+T71+iQBUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTI=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"val_loss_epoch","mention":"val_loss_epoch","matchorder":2,"begin":18659,"end":18673,"entityid":4983970369927898000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0.0009066420935888997,"attachedInfoBytes":"sgJjCg52YWxfbG9zc19lcG9jaBIHTWVkaWNhbBjjkQEg8ZEBKAI1uattOjoHYXJ0aWNsZUDwxP\u002F00tSnlUVIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy8gLUAQokNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUyGgdhcnRpY2xlIgkxOTk5NzE4OTY6DnZhbF9sb3NzX2Vwb2NoQPDE\u002F\u002FTS1KeVRUgSUhJhaV9lbnRpdHlfcmVjYWxsZXJduattOmJjCg52YWxfbG9zc19lcG9jaBIHTWVkaWNhbBjjkQEg8ZEBKAI1uattOjoHYXJ0aWNsZUDwxP\u002F00tSnlUVIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"label_dir","mention":"label_dir","matchorder":1,"begin":15310,"end":15319,"entityid":8138308600871914000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0.000884417730924153,"attachedInfoBytes":"sgJcCglsYWJlbF9kaXISB01lZGljYWwYzncg13coATVF2Gc6OgdhcnRpY2xlQOiW6NvckcX4cEgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTLyAsgBCiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTIaB2FydGljbGUiCTE5OTk3MTg5NjoJbGFiZWxfZGlyQOiW6NvckcX4cEgTUhJhaV9lbnRpdHlfcmVjYWxsZXJdRdhnOmJcCglsYWJlbF9kaXISB01lZGljYWwYzncg13coATVF2Gc6OgdhcnRpY2xlQOiW6NvckcX4cEgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTI=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"val_acc_epoch","mention":"val_acc_epoch","matchorder":1,"begin":18709,"end":18722,"entityid":-1561030168749517600,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0.0014777954340233213,"attachedInfoBytes":"sgJjCg12YWxfYWNjX2Vwb2NoEgdNZWRpY2FsGJWSASCikgEoATWWssE6OgdhcnRpY2xlQNaqkeDQ6oar6gFIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy8gLUAQokNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUyGgdhcnRpY2xlIgkxOTk5NzE4OTY6DXZhbF9hY2NfZXBvY2hA1qqR4NDqhqvqAUgVUhJhaV9lbnRpdHlfcmVjYWxsZXJdlrLBOmJjCg12YWxfYWNjX2Vwb2NoEgdNZWRpY2FsGJWSASCikgEoATWWssE6OgdhcnRpY2xlQNaqkeDQ6oar6gFIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"3层卷积神经网络","mention":"3层卷积神经网络","matchorder":1,"begin":8321,"end":8329,"entityid":-4117224681190556700,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Computer","score":0.0014660025770587837,"attachedInfoBytes":"sgJrChYz5bGC5Y2356ev56We57uP572R57ucEghDb21wdXRlchiBQSCJQSgBNeImwDo6B2FydGljbGVA4Pipyfa+q+7GAUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTLyAuUBCiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTIaB2FydGljbGUiCTE5OTk3MTg5NjoWM+WxguWNt+enr+elnue7j+e9kee7nEDg+KnJ9r6r7sYBSBZSEmFpX2VudGl0eV9yZWNhbGxlcl3iJsA6YmsKFjPlsYLljbfnp6\u002FnpZ7nu4\u002FnvZHnu5wSCENvbXB1dGVyGIFBIIlBKAE14ibAOjoHYXJ0aWNsZUDg+KnJ9r6r7sYBSABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMg==","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"torch.rand","mention":"torch.rand","matchorder":1,"begin":12468,"end":12478,"entityid":-2535448385092110300,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0.0014128552432035035,"attachedInfoBytes":"sgJeCgp0b3JjaC5yYW5kEgdNZWRpY2FsGLRhIL5hKAE1ji+5OjoHYXJ0aWNsZUCv8PzhiOSR6NwBSABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMvICzAEKJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMhoHYXJ0aWNsZSIJMTk5OTcxODk2Ogp0b3JjaC5yYW5kQK\u002Fw\u002FOGI5JHo3AFIF1ISYWlfZW50aXR5X3JlY2FsbGVyXY4vuTpiXgoKdG9yY2gucmFuZBIHTWVkaWNhbBi0YSC+YSgBNY4vuTo6B2FydGljbGVAr\u002FD84YjkkejcAUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTI=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"self.transform","mention":"self.transform","matchorder":1,"begin":7655,"end":7669,"entityid":8890170263170053000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0.0010081508116870919,"attachedInfoBytes":"sgJhCg5zZWxmLnRyYW5zZm9ybRIHTWVkaWNhbBjnOyD1OygBNe4jhDo6B2FydGljbGVA8+v3h4nYjrB7SABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMvIC0gEKJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMhoHYXJ0aWNsZSIJMTk5OTcxODk2Og5zZWxmLnRyYW5zZm9ybUDz6\u002FeHidiOsHtIGFISYWlfZW50aXR5X3JlY2FsbGVyXe4jhDpiYQoOc2VsZi50cmFuc2Zvcm0SB01lZGljYWwY5zsg9TsoATXuI4Q6OgdhcnRpY2xlQPPr94eJ2I6we0gAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTI=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"img_path","mention":"img_path","matchorder":9,"begin":6154,"end":6162,"entityid":-453506633697502460,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0006577556047146077,"attachedInfoBytes":"sgJZCghpbWdfcGF0aBIETWF0aBiKMCCSMCgJNTttLDo6B2FydGljbGVAjba1menDtNr5AUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTLyAsUBCiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTIaB2FydGljbGUiCTE5OTk3MTg5NjoIaW1nX3BhdGhAjba1menDtNr5AUgZUhJhaV9lbnRpdHlfcmVjYWxsZXJdO20sOmJZCghpbWdfcGF0aBIETWF0aBiKMCCSMCgJNTttLDo6B2FydGljbGVAjba1menDtNr5AUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTI=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"推理程序","mention":"推理程序","matchorder":1,"begin":21594,"end":21598,"entityid":-3498869611939305000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Computer","score":0.0006428228332354957,"attachedInfoBytes":"sgJjCgzmjqjnkIbnqIvluo8SCENvbXB1dGVyGNqoASDeqAEoATUcgyg6OgdhcnRpY2xlQJPUy4eDlOG4zwFIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy8gLTAQokNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUyGgdhcnRpY2xlIgkxOTk5NzE4OTY6DOaOqOeQhueoi+W6j0CT1MuHg5ThuM8BSBpSEmFpX2VudGl0eV9yZWNhbGxlcl0cgyg6YmMKDOaOqOeQhueoi+W6jxIIQ29tcHV0ZXIY2qgBIN6oASgBNRyDKDo6B2FydGljbGVAk9TLh4OU4bjPAUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTI=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"numpy","mention":"numpy","matchorder":4,"begin":4812,"end":4817,"entityid":-3761815577038084000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.000552113595112369,"attachedInfoBytes":"sgJWCgVudW1weRIETWF0aBjMJSDRJSgENbe7EDo6B2FydGljbGVAuc\u002F0oJ6V1uXLAUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTLyAr8BCiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTIaB2FydGljbGUiCTE5OTk3MTg5NjoFbnVtcHlAuc\u002F0oJ6V1uXLAUgbUhJhaV9lbnRpdHlfcmVjYWxsZXJdt7sQOmJWCgVudW1weRIETWF0aBjMJSDRJSgENbe7EDo6B2FydGljbGVAuc\u002F0oJ6V1uXLAUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTI=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"458 Non-trainable params","mention":"458 Non-trainable params","matchorder":1,"begin":5375,"end":5399,"entityid":4419845668347633700,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0.0031732117494334133,"attachedInfoBytes":"sgJrChg0NTggTm9uLXRyYWluYWJsZSBwYXJhbXMSB01lZGljYWwY\u002FykglyooATWp9U87OgdhcnRpY2xlQNe+o\u002F\u002F8xpyrPUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTLyAuYBCiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTIaB2FydGljbGUiCTE5OTk3MTg5NjoYNDU4IE5vbi10cmFpbmFibGUgcGFyYW1zQNe+o\u002F\u002F8xpyrPUgcUhJhaV9lbnRpdHlfcmVjYWxsZXJdqfVPO2JrChg0NTggTm9uLXRyYWluYWJsZSBwYXJhbXMSB01lZGljYWwY\u002FykglyooATWp9U87OgdhcnRpY2xlQNe+o\u002F\u002F8xpyrPUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTI=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"卷积神经网络","mention":"卷积神经网络","matchorder":1,"begin":72,"end":78,"entityid":-4793869240713638000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Computer","score":0.0006864146186796455,"attachedInfoBytes":"sgJlChLljbfnp6\u002FnpZ7nu4\u002FnvZHnu5wSCENvbXB1dGVyGEggTigBNYHwMzo6B2FydGljbGVAp57evLGqsLy9AUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTLyAtsBCiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTIaB2FydGljbGUiCTE5OTk3MTg5NjoS5Y2356ev56We57uP572R57ucQKee3ryxqrC8vQFIHVISYWlfZW50aXR5X3JlY2FsbGVyXYHwMzpiZQoS5Y2356ev56We57uP572R57ucEghDb21wdXRlchhIIE4oATWB8DM6OgdhcnRpY2xlQKee3ryxqrC8vQFIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"反向传播","mention":"反向传播","matchorder":1,"begin":17363,"end":17367,"entityid":5937373484804595000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0.0005544610128320887,"attachedInfoBytes":"sgJjCgzlj43lkJHkvKDmkq0SCU90aGVyVGVybRjThwEg14cBKAE1QFkROjoHYXJ0aWNsZUD1t+ekobfyslJIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy8gLSAQokNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUyGgdhcnRpY2xlIgkxOTk5NzE4OTY6DOWPjeWQkeS8oOaSrUD1t+ekobfyslJIHlISYWlfZW50aXR5X3JlY2FsbGVyXUBZETpiYwoM5Y+N5ZCR5Lyg5pKtEglPdGhlclRlcm0Y04cBINeHASgBNUBZETo6B2FydGljbGVA9bfnpKG38rJSSABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMg==","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"batch_size=bs","mention":"batch_size=bs","matchorder":2,"begin":15713,"end":15726,"entityid":-6737950045740238000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0010704759172752987,"attachedInfoBytes":"sgJeCg1iYXRjaF9zaXplPWJzEgRNYXRoGOF6IO56KAI1Nk+MOjoHYXJ0aWNsZUCi+M2Kn8T\u002FvqIBSABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMvICzwEKJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMhoHYXJ0aWNsZSIJMTk5OTcxODk2Og1iYXRjaF9zaXplPWJzQKL4zYqfxP++ogFIIVISYWlfZW50aXR5X3JlY2FsbGVyXTZPjDpiXgoNYmF0Y2hfc2l6ZT1icxIETWF0aBjheiDueigCNTZPjDo6B2FydGljbGVAovjNip\u002FE\u002F76iAUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTI=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"经典网络","mention":"经典网络","matchorder":1,"begin":971,"end":975,"entityid":-7618726807764244000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0009485175709214311,"attachedInfoBytes":"sgJgCgznu4\u002FlhbjnvZHnu5wSB1Vua25vd24YywcgzwcoATXwpXg6OgdhcnRpY2xlQPDQ3bPYirailgFIAFIkNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUy8gLVAQokNDlmZTNiMjQtOWNkNC00NWY3LWFlODktNTE2ODQxNjM2OWUyGgdhcnRpY2xlIgkxOTk5NzE4OTY6DOe7j+WFuOe9kee7nEDw0N2z2Iq2opYBSCJSF2JhaWR1LWJhaWtlLWl0ZW0tcmVjYWxsXfCleDpiYAoM57uP5YW4572R57ucEgdVbmtub3duGMsHIM8HKAE18KV4OjoHYXJ0aWNsZUDw0N2z2Iq2opYBSABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMg==","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"makedirs","mention":"makedirs","matchorder":3,"begin":5618,"end":5626,"entityid":5201783866287261000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Music","score":0.0009452887338380345,"attachedInfoBytes":"sgJZCghtYWtlZGlycxIFTXVzaWMY8isg+isoAzVBzXc6OgdhcnRpY2xlQLCEpOPb25yYSEgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTLyAsQBCiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTIaB2FydGljbGUiCTE5OTk3MTg5NjoIbWFrZWRpcnNAsISk49vbnJhISCNSEmFpX2VudGl0eV9yZWNhbGxlcl1BzXc6YlkKCG1ha2VkaXJzEgVNdXNpYxjyKyD6KygDNUHNdzo6B2FydGljbGVAsISk49vbnJhISABSJDQ5ZmUzYjI0LTljZDQtNDVmNy1hZTg5LTUxNjg0MTYzNjllMg==","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"val_data","mention":"val_data","matchorder":1,"begin":14971,"end":14979,"entityid":-2112138512696598500,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0.0005738120059194107,"attachedInfoBytes":"sgJcCgh2YWxfZGF0YRIHTWVkaWNhbBj7dCCDdSgBNd9rFjo6B2FydGljbGVAt8Cw0ummi9jiAUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTLyAsgBCiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTIaB2FydGljbGUiCTE5OTk3MTg5NjoIdmFsX2RhdGFAt8Cw0ummi9jiAUgkUhJhaV9lbnRpdHlfcmVjYWxsZXJd32sWOmJcCgh2YWxfZGF0YRIHTWVkaWNhbBj7dCCDdSgBNd9rFjo6B2FydGljbGVAt8Cw0ummi9jiAUgAUiQ0OWZlM2IyNC05Y2Q0LTQ1ZjctYWU4OS01MTY4NDE2MzY5ZTI=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""}],"id":503280155,"title":"PyTorch保姆级CNN实现mnist手写数字识别","type":"article","articleType":"normal","excerptTitle":"","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F503280155","imageUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-f08486417921004ec3292531e30c6683_720w.jpg?source=172ae18b","titleImage":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-f08486417921004ec3292531e30c6683_720w.jpg?source=172ae18b","excerpt":"\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-10f99252ef61aac0363129ade893c30c_200x112.jpg\" data-caption=\"CNN模型识别mnist\" data-size=\"normal\" data-rawwidth=\"500\" data-rawheight=\"288\" data-watermark=\"watermark\" data-original-src=\"v2-10f99252ef61aac0363129ade893c30c\" data-watermark-src=\"\" data-private-watermark-src=\"\" data-thumbnail=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-10f99252ef61aac0363129ade893c30c_720w.jpg?source=d16d100b\" class=\"origin_image inline-img zh-lightbox-thumb\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-10f99252ef61aac0363129ade893c30c_r.jpg\"\u002F\u003E前言： 毕业之后从事cv工作有两三年，从最初的卷积神经网络搭建，到现在目标检测、语义分割，一步步走来，遇到了太多的坑，本文从如何快速、清晰的实现一个cv的helloword之mnist手写数字识别。本文是新手级教程，大佬勿喷！ 代码地址：\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fgithub.com\u002Fzyf-xtu\u002FDL\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003EGitHub - zyf-xtu\u002FDL:…\u003C\u002Fa\u003E","created":1650889047,"updated":1650889047,"author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-7e8a664d6eaebdd351fced054cee2f6b.jpg?source=172ae18b","uid":"739864926201335808","userType":"people","isFollowing":false,"urlToken":"zhang-yun-fei-15-29","id":"e8ee2334d249cd097f6bfd7d9042d5ee","description":"旧时邮票很贵，一封信寄走我对你的思念，你离我很近。今日网络发达，一条“在吗？”却隔断你我，往事只剩寒暄，你我相隔更远！","name":"张云飞","isAdvertiser":false,"headline":"君子慎独卑以自牧","gender":1,"url":"\u002Fpeople\u002Fe8ee2334d249cd097f6bfd7d9042d5ee","avatarUrl":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-7e8a664d6eaebdd351fced054cee2f6b_l.jpg?source=172ae18b","isOrg":false,"type":"people","badge":[],"badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""},"exposedMedal":{"medalId":"972460827463282688","medalName":"表示赞同","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-c38ebd5a7d1f43a5ed9ac0411a3e233a_r.png?source=172ae18b","miniAvatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-c38ebd5a7d1f43a5ed9ac0411a3e233a_l.png?source=172ae18b","description":"赞同 5 次","medalAvatarFrame":""}},"commentPermission":"all","copyrightPermission":"need_review","state":"published","ipInfo":"","imageWidth":692,"imageHeight":371,"content":"\u003Cp data-pid=\"U3os1VNy\"\u003E前言：\u003C\u002Fp\u003E\u003Cp data-pid=\"heIB7mgG\"\u003E毕业之后从事cv工作有两三年，从最初的卷积神经网络搭建，到现在目标检测、语义分割，一步步走来，遇到了太多的坑，本文从如何快速、清晰的实现一个cv的helloword之mnist手写数字识别。本文是新手级教程，大佬勿喷！\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-10f99252ef61aac0363129ade893c30c_b.jpg\" data-size=\"normal\" data-rawwidth=\"500\" data-rawheight=\"288\" data-thumbnail=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-10f99252ef61aac0363129ade893c30c_720w.jpg?source=d16d100b\" class=\"origin_image zh-lightbox-thumb\" width=\"500\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-10f99252ef61aac0363129ade893c30c_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;500&#39; height=&#39;288&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"500\" data-rawheight=\"288\" data-thumbnail=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-10f99252ef61aac0363129ade893c30c_720w.jpg?source=d16d100b\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"500\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-10f99252ef61aac0363129ade893c30c_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-10f99252ef61aac0363129ade893c30c_b.jpg\" data-original-token=\"v2-10f99252ef61aac0363129ade893c30c\"\u002F\u003E\u003Cfigcaption\u003ECNN模型识别mnist\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Chr\u002F\u003E\u003Ch2\u003E代码地址：\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fgithub.com\u002Fzyf-xtu\u002FDL\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003EGitHub - zyf-xtu\u002FDL: deep learning\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\u003Cp data-pid=\"KfAJ24U4\"\u003E在\u003Cspan class=\"nolink\"\u003Eclassification\u002Fzyf_mnist\u003C\u002Fspan\u003E目录下\u003C\u002Fp\u003E\u003Cp data-pid=\"iprCUbbd\"\u003E如果对经典网络结构pytorch复现有兴趣的童鞋，请看我的关于Alexnet、VGG系列、Resnet系列、Inception系列等经典网络复现，具有超级详细的复现代码哦，地址：\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fgithub.com\u002Fzyf-xtu\u002Fpytorch_models\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttps:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Egithub.com\u002Fzyf-xtu\u002Fpyto\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003Erch_models\u003C\u002Fspan\u003E\u003Cspan class=\"ellipsis\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp data-pid=\"ep_u5P7R\"\u003E言归正传，开启代码之旅--------\u003C\u002Fp\u003E\u003Ch3\u003E一、数据处理部分\u003C\u002Fh3\u003E\u003Cp data-pid=\"EE0Cu85O\"\u003Emnist是一个手写字体的数字图像数据集，包含数字0-9共计70000张图像，其中训练集60000张测试集10000张，每张图像的大小为28*28。数据集详细介绍这里不讲了，有兴趣的同学可以查阅资料，数据集地址：\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fyann.lecun.com\u002Fexdb\u002Fmnist\u002F\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttp:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Eyann.lecun.com\u002Fexdb\u002Fmni\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003Est\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"ellipsis\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp data-pid=\"7HQVYsiJ\"\u003E下载来的数据是784维度的数组，并不是图像数据，这时候数据也是可以用的，但是我们总会感觉不靠谱，因为看不到图像数据，所以首先我们要把下载来的数据转化成图像。\u003C\u002Fp\u003E\u003Cp data-pid=\"mvA7Nb2p\"\u003E本文采用torchvision内部封装好的数据集部分torchvision.datasets来下载mnist\u003C\u002Fp\u003E\u003Cp data-pid=\"Gp0nZeY2\"\u003E部分代码如下，代码文件：mnist_save.py\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-python3\"\u003E\u003Cspan class=\"kn\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\"nn\"\u003Etorchvision.datasets\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emnist\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003Etrain_data\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emnist\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMNIST\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s1\"\u003E&#39;mnist&#39;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etrain\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"kc\"\u003ETrue\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etransform\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etransforms\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EToTensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Edownload\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"kc\"\u003ETrue\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003Etest_data\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emnist\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMNIST\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s1\"\u003E&#39;mnist&#39;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etrain\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"kc\"\u003EFalse\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etransform\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etransforms\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EToTensor\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(),\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Edownload\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"kc\"\u003ETrue\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003Etrain_loader\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Edata\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EDataLoader\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Edataset\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etrain_data\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ebatch_size\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eshuffle\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"kc\"\u003ETrue\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003Etest_loader\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Edata\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EDataLoader\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Edataset\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Etest_data\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ebatch_size\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eshuffle\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"kc\"\u003ETrue\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"opGA5ldE\"\u003E查看部分数据，进行可视化\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003Edef show():\n    plt.figure(figsize=(16, 9))\n    for i, item in enumerate(itertools.islice(train_loader,2,102)):\n        plt.subplot(10, 10, i+1)\n        img,label= item\n        img = img[0].cpu().numpy()\n        array = (img.reshape((28, 28)) * 255).astype(np.uint8)\n        img = Image.fromarray(array, &#39;L&#39;)\n        label = label.cpu().numpy()[0]\n        plt.imshow(img, cmap=plt.get_cmap(&#39;gray&#39;))\n    plt.show()\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-b73811052901fde356fcab190e023b86_b.jpg\" data-size=\"normal\" data-rawwidth=\"1166\" data-rawheight=\"768\" class=\"origin_image zh-lightbox-thumb\" width=\"1166\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-b73811052901fde356fcab190e023b86_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1166&#39; height=&#39;768&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"1166\" data-rawheight=\"768\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1166\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-b73811052901fde356fcab190e023b86_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-b73811052901fde356fcab190e023b86_b.jpg\" data-original-token=\"v2-2acf8be0cd5396c5dd4173d00c8876c4\"\u002F\u003E\u003Cfigcaption\u003Emnist可视化展示\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"A5z7Ncc6\"\u003E这里需要将数据转化成图像格式，并保存下来，每个图像保存到各自对应的文件夹下，\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E# 将mnist保存为图像\ndef save():\n    os.makedirs(&#39;mnist\u002Ftrain&#39;, exist_ok=True)\n    os.makedirs(&#39;mnist\u002Ftest&#39;, exist_ok=True)\n    for i in range(10):\n        os.makedirs(&#39;mnist\u002Ftrain\u002F&#39; + str(i), exist_ok=True)\n        os.makedirs(&#39;mnist\u002Ftest\u002F&#39; + str(i), exist_ok=True)\n    # 保存训练集\n    for i, item in enumerate(train_loader):\n        img, label = item\n        img = img[0].cpu().numpy()\n        array = (img.reshape((28, 28)) * 255).astype(np.uint8)\n        img = Image.fromarray(array, &#39;L&#39;)\n        label = label.cpu().numpy()[0]\n        img_path = &#39;mnist\u002Ftrain\u002F&#39; + str(label) + &#39;\u002F&#39; + str(i) + &#39;.jpg&#39;\n        print(img_path)\n        img.save(img_path)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-4a4405e64f88f1c1ca47cd47e48cd919_b.jpg\" data-size=\"normal\" data-rawwidth=\"2210\" data-rawheight=\"278\" class=\"origin_image zh-lightbox-thumb\" width=\"2210\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-4a4405e64f88f1c1ca47cd47e48cd919_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;2210&#39; height=&#39;278&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"2210\" data-rawheight=\"278\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"2210\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-4a4405e64f88f1c1ca47cd47e48cd919_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-4a4405e64f88f1c1ca47cd47e48cd919_b.jpg\" data-original-token=\"v2-4a4405e64f88f1c1ca47cd47e48cd919\"\u002F\u003E\u003Cfigcaption\u003E0-9文件夹\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-858f47236835767f0598cda8b260689a_b.jpg\" data-size=\"normal\" data-rawwidth=\"2388\" data-rawheight=\"446\" class=\"origin_image zh-lightbox-thumb\" width=\"2388\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-858f47236835767f0598cda8b260689a_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;2388&#39; height=&#39;446&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"2388\" data-rawheight=\"446\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"2388\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-858f47236835767f0598cda8b260689a_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-858f47236835767f0598cda8b260689a_b.jpg\" data-original-token=\"v2-d53814cd1d726d6cadf62ee13f46eb18\"\u002F\u003E\u003Cfigcaption\u003E文件夹1内的数据\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"kQiXB1K0\"\u003E我们数据下载来了，大部分情况下，pytorch自带的加载数据模块并不适用我们自己的数据，所以接下来需要需要重构加载数据模块，本文采用pytorch自带的datasets为基类，进行重构数据加载部分，需要继承torch.utils.data.Dataset类，自定义数据集时，需要覆盖两个方法：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"5FdvLfaJ\"\u003E__len__:len(dataset) 数据集大小\u003C\u002Fli\u003E\u003Cli data-pid=\"xu9bOJiS\"\u003E__getitem__:dataset[i] 第i个数据\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"JDp537oP\"\u003E代码文件：mnist_dataset.py\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E# 自定义数据读取\nclass MnistData(Dataset):\n    def __init__(self, data, transform=None, target_transform=None):\n        super(Dataset, self).__init__()\n        self.transform = transform\n        self.target_transform = target_transform\n        self.samples = data\n\n    def __len__(self):\n        return len(self.samples)\n\n    def __getitem__(self, index):\n        img_path, target = self.samples[index]\n        img = Image.open(img_path).convert(&#39;RGB&#39;)\n        if self.transform is not None:\n            img = self.transform(img)\n        if self.target_transform is not None:\n            target = self.target_transform(target)\n\n        return img, target\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"_ym3qY1f\"\u003E数据加载部分完成。\u003C\u002Fp\u003E\u003Ch3\u003E二、网络模型\u003C\u002Fh3\u003E\u003Cp data-pid=\"Sg5AeWub\"\u003E由于mnist的图像大小为28*28，如vgg、resnet等网络的入网尺寸较之太大，故不太适合mnist数据集，这里我们自定义实现一个简单的3层卷积神经网络，包含conv、bn、relu、pool等网络基本单元。\u003C\u002Fp\u003E\u003Cp data-pid=\"xQj3ncR5\"\u003E网络结构图：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-60ccf701cfb32b53cf035d7b6e9bb648_b.jpg\" data-size=\"normal\" data-rawwidth=\"1366\" data-rawheight=\"732\" class=\"origin_image zh-lightbox-thumb\" width=\"1366\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-60ccf701cfb32b53cf035d7b6e9bb648_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1366&#39; height=&#39;732&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"1366\" data-rawheight=\"732\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1366\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-60ccf701cfb32b53cf035d7b6e9bb648_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-60ccf701cfb32b53cf035d7b6e9bb648_b.jpg\" data-original-token=\"v2-9a3dfd66cf977a1cecf5cd456a066621\"\u002F\u003E\u003Cfigcaption\u003Ecnn结构（画图太糙）\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"02vPBffS\"\u003E网络结构：本网络包含三个卷积部分，一个自适应池化和一个全连接层，其中每个卷积部分包含卷积、归一化、激活函数和池化，基本流程：\u003C\u002Fp\u003E\u003Cp data-pid=\"pfIoALpc\"\u003E                input--&gt;conv1--&gt;conv2--&gt;conv3--&gt;advpool--&gt;fc\u003C\u002Fp\u003E\u003Cp data-pid=\"7VLoIR_I\"\u003E卷积核池化计算公式：\u003C\u002Fp\u003E\u003Cp data-pid=\"PaVWPaWk\"\u003E卷积：\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fpytorch.org\u002Fdocs\u002Fstable\u002Fgenerated\u002Ftorch.nn.Conv2d.html%23torch.nn.Conv2d\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003EConv2d - PyTorch 1.11.0 documentation\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-bb62b7a951efe7472ef40b8f20ea6e58_b.jpg\" data-size=\"normal\" data-rawwidth=\"789\" data-rawheight=\"622\" class=\"origin_image zh-lightbox-thumb\" width=\"789\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-bb62b7a951efe7472ef40b8f20ea6e58_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;789&#39; height=&#39;622&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"789\" data-rawheight=\"622\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"789\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-bb62b7a951efe7472ef40b8f20ea6e58_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-bb62b7a951efe7472ef40b8f20ea6e58_b.jpg\" data-original-token=\"v2-ae675b389b3eb168417fa1d668fcad04\"\u002F\u003E\u003Cfigcaption\u003E卷积计算公式（来源官方文档）\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"Exge9s8s\"\u003E池化：\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fpytorch.org\u002Fdocs\u002Fstable\u002Fgenerated\u002Ftorch.nn.MaxPool2d.html%23torch.nn.MaxPool2d\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003EMaxPool2d - PyTorch 1.11.0 documentation\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-ae00097f3e65d5d3a546bf652d384b01_b.jpg\" data-size=\"normal\" data-rawwidth=\"795\" data-rawheight=\"566\" class=\"origin_image zh-lightbox-thumb\" width=\"795\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-ae00097f3e65d5d3a546bf652d384b01_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;795&#39; height=&#39;566&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"795\" data-rawheight=\"566\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"795\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-ae00097f3e65d5d3a546bf652d384b01_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-ae00097f3e65d5d3a546bf652d384b01_b.jpg\" data-original-token=\"v2-53e1fb35793a93f64ccedb5c158ce924\"\u002F\u003E\u003Cfigcaption\u003E池化计算公式（来源官方文档）\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"s7bUuRRq\"\u003E注意：卷积和池化默认是向下取整，其中池化可以通过ceil_mode=True设置为向上取整。\u003C\u002Fp\u003E\u003Cp data-pid=\"NiwpvXbc\"\u003E数据流向和代码实现如下：CNN.py\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E# CNN分类网络\nclass CnnNet(nn.Module):\n    def __init__(self, classes=10):\n        super(CnnNet, self).__init__()\n        # 分类数\n        self.classes = classes\n        # 第一层卷积，输入：bs*3*28*28 输出：bs*16*14*14\n        self.conv1 = nn.Sequential(\n            # 卷积 输入：bs*3*28*28  输出：bs*16*28*28\n            nn.Conv2d(in_channels=3, out_channels=16, kernel_size=3, stride=1, padding=1),\n            # 归一化\n            nn.BatchNorm2d(16),\n            # 激活函数\n            nn.ReLU(),\n            # 最大池化：输入:bs*16*28*28  输出：bs*16*14*14\n            nn.MaxPool2d(2)\n        )\n        # 第二层卷积，输入：bs*16*14*14 输出：bs*64*7*7\n        self.conv2 = nn.Sequential(\n            # 卷积 输入：bs*16*14*14  输出：bs*32*14*14\n            nn.Conv2d(in_channels=16, out_channels=32, kernel_size=3, stride=1, padding=1),\n            # 归一化\n            nn.BatchNorm2d(32),\n            # 激活函数\n            nn.ReLU(),\n            # 最大池化：输入:bs*16*14*14  输出：bs*32*7*7\n            nn.MaxPool2d(2)\n        )\n        # 第三层卷积，输入：bs*32*7*7 输出：bs*64*3*3\n        self.conv3 = nn.Sequential(\n            # 卷积 输入：bs*32*7*7  输出：bs*64*3*3\n            nn.Conv2d(in_channels=32, out_channels=64, kernel_size=3, stride=1, padding=1),\n            # 归一化\n            nn.BatchNorm2d(64),\n            # 激活函数\n            nn.ReLU(),\n            # 最大池化：输入：bs*32*7*7 输出：bs*64*3*3\n            nn.MaxPool2d(2)\n        )\n        # 自适应池化，将bs*64*3*3映射为bs*64*1*1\n        self.advpool = nn.AdaptiveAvgPool2d((1, 1))\n        # 全连接层\n        self.fc = nn.Linear(64, self.classes)\n\n    def forward(self, x):\n        x = self.conv1(x)\n        x = self.conv2(x)\n        x = self.conv3(x)\n        x = self.advpool(x)\n        # 需要将多维度的值展平为一维，送入linear中，但是需要保持batchsize的维度\n        # 例如2*64*1*1 变成2*64\n        out = x.view(x.size(0), -1)\n        out = self.fc(out)\n        return out\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"3cYQXaOY\"\u003E使用torchsummary查看网络结构、参数量、模型大小\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E    # 测试数据\n    x = torch.rand((2, 3, 28, 28))\n    cnn = CnnNet(classes=10)\n    print(cnn)\n    out = cnn(x)\n    print(out)\n    device = torch.device(&#39;cuda&#39; if torch.cuda.is_available() else &#39;cpu&#39;)\n    cnn = cnn.to(device)\n    # 网络模型的数据流程及参数信息\n    summary(cnn, (3, 28, 28))\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"cafyNz6a\"\u003E结果如下：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E---------------------------------------------------------------\n        Layer (type)               Output Shape         Param #\n================================================================\n            Conv2d-1           [-1, 16, 28, 28]             448\n       BatchNorm2d-2           [-1, 16, 28, 28]              32\n              ReLU-3           [-1, 16, 28, 28]               0\n         MaxPool2d-4           [-1, 16, 14, 14]               0\n            Conv2d-5           [-1, 32, 14, 14]           4,640\n       BatchNorm2d-6           [-1, 32, 14, 14]              64\n              ReLU-7           [-1, 32, 14, 14]               0\n         MaxPool2d-8             [-1, 32, 7, 7]               0\n            Conv2d-9             [-1, 64, 7, 7]          18,496\n      BatchNorm2d-10             [-1, 64, 7, 7]             128\n             ReLU-11             [-1, 64, 7, 7]               0\n        MaxPool2d-12             [-1, 64, 3, 3]               0\nAdaptiveAvgPool2d-13             [-1, 64, 1, 1]               0\n           Linear-14                   [-1, 10]             650\n================================================================\nTotal params: 24,458\nTrainable params: 24,458\nNon-trainable params: 0\n----------------------------------------------------------------\nInput size (MB): 0.01\nForward\u002Fbackward pass size (MB): 0.54\nParams size (MB): 0.09\nEstimated Total Size (MB): 0.65\n----------------------------------------------------------------\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch3\u003E三、训练部分\u003C\u002Fh3\u003E\u003Cp data-pid=\"UJzdLpN7\"\u003E前两部分完成了数据处理和模型设计，本小节实现如何使用模型对mnist数据集进行识别训练\u003C\u002Fp\u003E\u003Cp data-pid=\"WDqHhqyo\"\u003E首先设置超参数：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E    # batchsize\n    bs = 32\n    # learning rate\n    lr = 0.01\n    # epoch\n    epoch = 100\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"zLxh4gJ8\"\u003E然后加载训练集数据，并将数据划分为训练集和验证集\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E# 将数据集划分训练集和验证集\ndef split_data(files):\n    &#34;&#34;&#34;\n    :param files:\n    :return:\n    &#34;&#34;&#34;\n    random.shuffle(files)\n    # 计算比例系数，分割数据训练集和验证集\n    ratio = 0.9\n    offset = int(len(files) * ratio)\n    train_data = files[:offset]\n    val_data = files[offset:]\n    return train_data, val_data\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"8VxPQmxK\"\u003E加载数据，使用自定数据处理MnistData类\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E    # 训练0-9的数据\n    labels = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n    base_dir = &#39;..\u002Fmnist\u002Ftrain&#39;\n    imgs = []\n    # 获取数据\n    for label in labels:\n        label_dir = os.path.join(base_dir, str(label))\n        images = os.listdir(label_dir)\n        for img in images:\n            img_path = os.path.join(label_dir, img)\n            imgs.append((img_path, label))\n    print(len(imgs))\n    # 将训练数据拆分成训练集和验证集\n    trains, vals = split_data(imgs)\n    # 加载训练集数据\n    train_dataset = MnistData(trains, transform=transform)\n    train_data = DataLoader(train_dataset, batch_size=bs, shuffle=True, num_workers=0)\n    # 加载验证集数据\n    val_dataset = MnistData(vals, transform=transform)\n    val_data = DataLoader(val_dataset, batch_size=bs, shuffle=True, num_workers=0)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"SxXWEN2N\"\u003E加载模型，设置损失函数交叉熵损失、优化器SGD\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E    # 加载模型\n    model = CnnNet(classes=10)\n    # GPU是否可用，如果可用，则使用GPU\n    device = torch.device(&#39;cuda&#39; if torch.cuda.is_available() else &#39;cpu&#39;)\n    model.to(device)\n    # 损失函数\n    loss_func = nn.CrossEntropyLoss()\n    # 优化器，使用SGD,可换Adam\n    optimizer = torch.optim.SGD(model.parameters(), lr=lr, weight_decay=1e-3)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"zSvEO1Qt\"\u003E训练&amp;输出训练日志&amp;保存best模型&amp;保存last模型\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E# 训练\ndef train(model, loss_func, optimizer, checkpoints, epoch):\n    print(&#39;Train......................&#39;)\n    # 记录每个epoch的loss和acc\n    best_acc = 0\n    best_epoch = 0\n    # 训练过程\n    for epoch in range(1, epoch):\n        # 设置计时器，计算每个epoch的用时\n        start_time = time.time()\n        model.train()  # 保证每一个batch都能进入model.train()的模式\n        # 记录每个epoch的loss和acc\n        train_loss, train_acc, val_loss, val_acc = 0, 0, 0, 0\n        for i, (inputs, labels) in enumerate(train_data):\n            # print(batch_size)\n            # print(i, inputs, labels)\n            inputs = inputs.to(device)\n            labels = labels.to(device)\n            # 预测输出\n            outputs = model(inputs)\n            # 计算损失\n            loss = loss_func(outputs, labels)\n            # print(outputs)\n            # 因为梯度是累加的，需要清零\n            optimizer.zero_grad()\n            # 反向传播\n            loss.backward()\n            # 优化器\n            optimizer.step()\n            # 计算准确率\n            output = nn.functional.softmax(outputs, dim=1)\n            pred = torch.argmax(output, dim=1)\n            acc = torch.sum(pred == labels)\n            train_loss += loss.item()\n            train_acc += acc.item()\n        # 验证集进行验证\n        model.eval()\n        with torch.no_grad():\n            for i, (inputs, labels) in enumerate(val_data):\n                inputs = inputs.to(device)\n                labels = labels.to(device)\n                # 预测输出\n                outputs = model(inputs)\n                # 计算损失\n                loss = loss_func(outputs, labels)\n                # 计算准确率\n                output = nn.functional.softmax(outputs, dim=1)\n                pred = torch.argmax(output, dim=1)\n                # print(pred,&#39;================&#39;)\n                # print(pred==labels,&#39;=====----------======&#39;)\n                acc = torch.sum(pred == labels)\n                # acc = calculat_acc(outputs, labels)\n                val_loss += loss.item()\n                val_acc += acc.item()\n\n        # 计算每个epoch的训练损失和精度\n        train_loss_epoch = train_loss \u002F train_data_size\n        train_acc_epoch = train_acc \u002F train_data_size\n        # 计算每个epoch的验证集损失和精度\n        val_loss_epoch = val_loss \u002F val_data_size\n        val_acc_epoch = val_acc \u002F val_data_size\n        end_time = time.time()\n        print(\n            &#39;epoch:{} | time:{:.4f} | train_loss:{:.4f} | train_acc:{:.4f} | eval_loss:{:.4f} | val_acc:{:.4f}&#39;.format(\n                epoch,\n                end_time - start_time,\n                train_loss_epoch,\n                train_acc_epoch,\n                val_loss_epoch,\n                val_acc_epoch))\n\n        # 记录验证集上准确率最高的模型\n        best_model_path = checkpoints + &#34;\u002F&#34; + &#39;best_model&#39; + &#39;.pth&#39;\n        if val_acc_epoch &gt;= best_acc:\n            best_acc = val_acc_epoch\n            best_epoch = epoch\n            torch.save(model, best_model_path)\n        print(&#39;Best Accuracy for Validation :{:.4f} at epoch {:d}&#39;.format(best_acc, best_epoch))\n        # 每迭代50次保存一次模型\n        # if epoch % 50 == 0:\n        #     model_name = &#39;\u002Fepoch_&#39; + str(epoch) + &#39;.pt&#39;\n        #     torch.save(model, checkpoints + model_name)\n    # 保存最后的模型\n    torch.save(model, checkpoints + &#39;\u002Flast.pt&#39;)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"MxM177fx\"\u003E训练日志输出&amp;10个epoch能达到98.5%的准确率\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003ETrain......................\nepoch:1 | time:80.9573 | train_loss:0.0238 | train_acc:0.8472 | eval_loss:0.0118 | val_acc:0.8898\nBest Accuracy for Validation :0.8898 at epoch 1\nepoch:2 | time:68.9780 | train_loss:0.0059 | train_acc:0.9597 | eval_loss:0.0044 | val_acc:0.9667\nBest Accuracy for Validation :0.9667 at epoch 2\nepoch:3 | time:59.8687 | train_loss:0.0038 | train_acc:0.9710 | eval_loss:0.0060 | val_acc:0.9463\nBest Accuracy for Validation :0.9667 at epoch 2\nepoch:4 | time:58.2875 | train_loss:0.0030 | train_acc:0.9769 | eval_loss:0.0026 | val_acc:0.9803\nBest Accuracy for Validation :0.9803 at epoch 4\nepoch:5 | time:77.2991 | train_loss:0.0026 | train_acc:0.9805 | eval_loss:0.0022 | val_acc:0.9828\nBest Accuracy for Validation :0.9828 at epoch 5\nepoch:6 | time:77.8352 | train_loss:0.0023 | train_acc:0.9827 | eval_loss:0.0020 | val_acc:0.9852\nBest Accuracy for Validation :0.9852 at epoch 6\nepoch:7 | time:76.7014 | train_loss:0.0021 | train_acc:0.9842 | eval_loss:0.0020 | val_acc:0.9837\nBest Accuracy for Validation :0.9852 at epoch 6\nepoch:8 | time:76.4207 | train_loss:0.0019 | train_acc:0.9854 | eval_loss:0.0021 | val_acc:0.9845\nBest Accuracy for Validation :0.9852 at epoch 6\nepoch:9 | time:76.3831 | train_loss:0.0017 | train_acc:0.9875 | eval_loss:0.0029 | val_acc:0.9765\nBest Accuracy for Validation :0.9852 at epoch 6\nepoch:10 | time:86.7663 | train_loss:0.0016 | train_acc:0.9878 | eval_loss:0.0026 | val_acc:0.9775\nBest Accuracy for Validation :0.9852 at epoch 6\nepoch:11 | time:88.5357 | train_loss:0.0015 | train_acc:0.9885 | eval_loss:0.0019 | val_acc:0.9842\nBest Accuracy for Validation :0.9852 at epoch 6\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch3\u003E四、推理部分\u003C\u002Fh3\u003E\u003Cp data-pid=\"YtRx7CDW\"\u003E完成了模型训练和模型保存，我们需要写一个推理程序来验证我们的模型是否能够具有识别mnist的能力，我看过很多博客，都忽略了推理预测模块的代码，本文从加载模型到预测结果详细的进行推理。\u003C\u002Fp\u003E\u003Cp data-pid=\"0gXMYRHC\"\u003E加载模型：mnist_infer.py\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E   model_path = &#39;checkpoints\u002Fbest_model.pth&#39;\n   # 加载模型\n   self.model = torch.load(model_path)\n   self.device = torch.device(&#39;gpu&#39; if torch.cuda.is_available() else &#39;cpu&#39;)\n   self.model = self.model.to(self.device)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"aQw8smoM\"\u003E推理部分：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E    # 预测\n    def predict(self, img_path):\n        transform = transforms.Compose([\n            transforms.ToTensor()\n        ])\n        img = Image.open(img_path)\n        img = img.convert(&#39;RGB&#39;)\n        img = transform(img)\n        img = img.view(1, 3, 28, 28).to(self.device)\n        output = self.model(img)\n        output = torch.softmax(output, dim=1)\n        # 每个预测值的概率\n        probability = output.cpu().detach().numpy()\n        # 找出最大概率值的索引\n        output = torch.argmax(output, dim=1)\n        index = output.cpu().numpy()[0]\n        # 预测结果\n        pred = self.labels[index]\n        print(pred, probability)\n        return pred\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"XCS58VMO\"\u003E推理示例：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E    img_path = &#39;..\u002Fmnist\u002Ftest\u002F1\u002F12.jpg&#39;\n    pred = Pred()\n    res = pred.predict(img_path)\n    print(res)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"qcDGXr3a\"\u003E推理结果为：1  概率为：0.993848\u003C\u002Fp\u003E\u003Cp data-pid=\"mYA_30kL\"\u003E完结，文笔简陋，如有错误，请批评指出，谢谢！\u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E","contentNeedTruncated":false,"adminClosedComment":false,"topics":[{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F20073557","type":"topic","id":"20073557","name":"手写数字识别"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19813032","type":"topic","id":"19813032","name":"深度学习（Deep Learning）"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F20043586","type":"topic","id":"20043586","name":"卷积神经网络（CNN）"}],"voteupCount":26,"voting":0,"heavyUpStatus":"allow_heavy_up","commentCount":10,"contributions":[],"isTitleImageFullScreen":false,"upvotedFollowees":[],"commercialInfo":{"isCommercial":false,"plugin":{}},"suggestEdit":{"status":false,"reason":"","tip":"","url":"","title":""},"reason":"","annotationAction":[],"canTip":false,"tipjarorsCount":0,"isLabeled":false,"hasPublishingDraft":false,"isFavorited":false,"favlistsCount":104,"isNormal":true,"status":0,"activityToppingInfo":{"state":"untopped"},"shareText":"PyTorch保姆级CNN实现mnist手写数字识别 - 来自知乎专栏，作者: 张云飞 https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F503280155 （想看更多？下载 @知乎 App：http:\u002F\u002Fweibo.com\u002Fp\u002F100404711598 ）","canComment":{"status":true,"reason":""},"mcnFpShow":-1,"isVisible":true,"isLiked":false,"likedCount":9,"hasColumn":false,"republishers":[],"isNewLinkCard":true,"emojiReaction":{"likeCount":9,"likeHasSet":false},"abParam":{"pnNbtoolbar":"0","qaFotoolbar":"1","qaHiddenVoteup":"1","qaNewdownvote":"0","rsInterest1":"","zpZhiStyle":""},"attachedInfo":"kgIkCgkxOTk5NzE4OTYSCTUwMzI4MDE1NRgHIgpJTUFHRV9URVhU","shareGuide":{"hasPositiveBubble":false,"hasTimeBubble":false,"hitShareGuideCluster":false},"settings":{"tableOfContents":{"enabled":true}},"canReference":false,"reactionInstruction":{},"reaction":{"statistics":{"upVoteCount":26,"downVoteCount":1,"likeCount":9,"commentCount":10,"shareCount":0,"playCount":0,"interestPlayCount":0,"favorites":104,"pvCount":0,"bulletCount":0,"applaudCount":0,"questionFollowerCount":0,"questionAnswerCount":0,"plaincontentVoteUpCount":0,"plaincontentLikeCount":0,"imgLikeCount":{"v210f99252ef61aac0363129ade893c30c":0,"v22acf8be0cd5396c5dd4173d00c8876c4":0,"v24a4405e64f88f1c1ca47cd47e48cd919":0,"v253e1fb35793a93f64ccedb5c158ce924":0,"v29a3dfd66cf977a1cecf5cd456a066621":0,"v2Ae675b389b3eb168417fa1d668fcad04":0,"v2D53814cd1d726d6cadf62ee13f46eb18":0,"v2F08486417921004ec3292531e30c6683":0}},"relation":{"isAuthor":false,"vote":"Neutral","liked":false,"imgLiked":{"v210f99252ef61aac0363129ade893c30c":false,"v22acf8be0cd5396c5dd4173d00c8876c4":false,"v24a4405e64f88f1c1ca47cd47e48cd919":false,"v253e1fb35793a93f64ccedb5c158ce924":false,"v29a3dfd66cf977a1cecf5cd456a066621":false,"v2Ae675b389b3eb168417fa1d668fcad04":false,"v2D53814cd1d726d6cadf62ee13f46eb18":false,"v2F08486417921004ec3292531e30c6683":false},"faved":false},"imageReactions":{"v210f99252ef61aac0363129ade893c30c":{"likeCount":0,"isLiked":false},"v22acf8be0cd5396c5dd4173d00c8876c4":{"likeCount":0,"isLiked":false},"v24a4405e64f88f1c1ca47cd47e48cd919":{"likeCount":0,"isLiked":false},"v253e1fb35793a93f64ccedb5c158ce924":{"likeCount":0,"isLiked":false},"v29a3dfd66cf977a1cecf5cd456a066621":{"likeCount":0,"isLiked":false},"v2Ae675b389b3eb168417fa1d668fcad04":{"likeCount":0,"isLiked":false},"v2D53814cd1d726d6cadf62ee13f46eb18":{"likeCount":0,"isLiked":false},"v2F08486417921004ec3292531e30c6683":{"likeCount":0,"isLiked":false}}},"interactionBarPlugins":[{"type":"comment","comment":{"enable":true,"placeholder":"发条带图评论"}}],"barPluginsFlipTime":3000}},"columns":{},"topics":{},"roundtables":{},"favlists":{},"comments":{},"notifications":{},"ebooks":{},"activities":{},"feeds":{},"pins":{},"promotions":{},"drafts":{},"chats":{},"posts":{},"zvideos":{},"zvideoContributions":{},"eduCourses":{}},"currentUser":"c29982ea4958b35f1d733b99ef5bf579","account":{"unlockTicketStatus":false,"unlockTicket":null,"challenge":[],"errorStatus":false,"message":"","isFetching":false,"accountInfo":{},"urlToken":{"loading":false},"cardUserInfo":{"vipInfo":{}},"handleWidget":{},"widgetList":[],"userWidgetId":""},"settings":{"socialBind":null,"inboxMsg":null,"notification":{},"email":{},"privacyFlag":null,"blockedUsers":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"blockedFollowees":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"ignoredTopics":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"restrictedTopics":null,"laboratory":{}},"notification":{},"people":{"profileStatus":{},"activitiesByUser":{},"answersByUser":{},"answersSortByVotesByUser":{},"answersIncludedByUser":{},"votedAnswersByUser":{},"thankedAnswersByUser":{},"voteAnswersByUser":{},"thankAnswersByUser":{},"topicAnswersByUser":{},"zvideosByUser":{},"articlesByUser":{},"articlesSortByVotesByUser":{},"articlesIncludedByUser":{},"pinsByUser":{},"questionsByUser":{},"commercialQuestionsByUser":{},"favlistsByUser":{},"followingByUser":{},"followersByUser":{},"mutualsByUser":{},"followingColumnsByUser":{},"followingQuestionsByUser":{},"followingFavlistsByUser":{},"followingTopicsByUser":{},"publicationsByUser":{},"columnsByUser":{},"allFavlistsByUser":{},"brands":null,"creationsByUser":{},"creationsSortByVotesByUser":{},"creationsFeed":{},"infinity":{},"batchUsers":{},"profileInfinity":null},"env":{"ab":{"config":{},"triggers":{}},"abV2":{"config":{"paramMap":{"ws_publish_post":{"value":"1","abId":"rl-publish_article-1"},"pc_mou_cre_remove":{"value":"1","abId":"rl-mou_create_remove-1"},"ws_qiangzhisafe":{"value":"1","abId":"rl-qiangzhisafe_copy-1"},"ws_platform_new":{"value":"1","abId":"author_platform-1"},"ws_video_publish":{"value":"1","abId":"rl-video_contentpub-1"},"ws_publish_answer":{"value":"1","abId":"rl-pc_pub_answer_2-1"},"ws_publish_ask":{"value":"1","abId":"rl-pc_publish_ask-1"},"ws_PC_AIfaxian":{"value":"0","abId":"PC_AIfaxian-0"}},"abMap":{"rl-publish_article-1":{"abId":"rl-publish_article-1","layerId":"rl-publish_article","diversionType":2},"rl-mou_create_remove-1":{"abId":"rl-mou_create_remove-1","layerId":"rl-mou_create_remove","diversionType":2},"rl-qiangzhisafe_copy-1":{"abId":"rl-qiangzhisafe_copy-1","layerId":"rl-qiangzhisafe_copy"},"author_platform-1":{"abId":"author_platform-1","layerId":"author_platform_layer","diversionType":2},"rl-video_contentpub-1":{"abId":"rl-video_contentpub-1","layerId":"rl-video_contentpub","diversionType":2},"rl-pc_pub_answer_2-1":{"abId":"rl-pc_pub_answer_2-1","layerId":"rl-pc_pub_answer_2","diversionType":2},"rl-pc_publish_ask-1":{"abId":"rl-pc_publish_ask-1","layerId":"rl-pc_publish_ask","diversionType":2},"PC_AIfaxian-0":{"abId":"PC_AIfaxian-0","layerId":"web_standard_domain_layer17","diversionType":2}}},"triggers":{}},"userAgent":{"Edge":false,"IE":false,"Wechat":false,"Weibo":false,"QQ":false,"MQQBrowser":false,"Qzone":false,"Mobile":false,"Android":false,"HarmonyOS":false,"iOS":false,"isAppleDevice":false,"Zhihu":false,"ZhihuHybrid":false,"isBot":false,"Tablet":false,"UC":false,"Quark":false,"Sogou":false,"Qihoo":false,"Baidu":false,"BaiduApp":false,"Safari":false,"GoogleBot":false,"AndroidDaily":false,"iOSDaily":false,"WxMiniProgram":false,"BaiduMiniProgram":false,"QQMiniProgram":false,"JDMiniProgram":false,"isWebView":false,"isMiniProgram":false,"origin":"Mozilla\u002F5.0 (X11; Linux x86_64) AppleWebKit\u002F537.36 (KHTML, like Gecko) Chrome\u002F114.0.0.0 Safari\u002F537.36"},"appViewConfig":{},"ctx":{"path":"\u002Fp\u002F503280155","query":{},"href":"http:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F503280155","host":"zhuanlan.zhihu.com"},"trafficSource":"production","edition":{"beijing":true,"baidu":false,"sogou":false,"baiduBeijing":false,"sogouBeijing":false,"sogouInput":false,"oppoSearch":false,"baiduSearch":false,"googleSearch":false,"shenma":false,"miniProgram":false,"xiaomi":false,"huaweiSearch":false},"theme":"light","appHeaderTheme":{"current":"normal","disable":true,"normal":{"bgColor":"GBK99A"},"custom":{"bgColor":"GBK99A"}},"enableShortcut":true,"referer":"https:\u002F\u002Fcn.bing.com\u002F","xUDId":"AIAe75fvzhSPTpeNw8WYbUTCwgHWLCTfJt8=","mode":"ssr","conf":{},"xTrafficFreeOrigin":"","ipInfo":{"cityName":"北京","countryName":"中国","regionName":"北京","countryCode":"CN"},"logged":true,"vars":{"passThroughHeaders":{}}},"me":{"columnContributions":[]},"label":{},"ecommerce":{},"comments":{"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"parent":{}},"commentsV2":{"stickers":[],"commentWithPicPermission":{},"notificationsComments":{},"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"conversationMore":{},"parent":{}},"pushNotifications":{"default":{"isFetching":false,"isDrained":false,"ids":[]},"follow":{"isFetching":false,"isDrained":false,"ids":[]},"vote_thank":{"isFetching":false,"isDrained":false,"ids":[]},"currentTab":"default","notificationsCount":{"default":0,"follow":0,"vote_thank":0}},"messages":{"data":{},"currentTab":"common","messageCount":0},"register":{"registerValidateSucceeded":null,"registerValidateErrors":{},"registerConfirmError":null,"sendDigitsError":null,"registerConfirmSucceeded":null},"login":{"loginUnregisteredError":false,"loginBindWechatError":false,"loginConfirmError":null,"sendDigitsError":null,"needSMSIdentify":false,"validateDigitsError":false,"loginConfirmSucceeded":null,"qrcodeLoginToken":"","qrcodeLoginScanStatus":0,"qrcodeLoginError":null,"qrcodeLoginReturnNewToken":false},"switches":{},"captcha":{"captchaNeeded":false,"captchaValidated":false},"sms":{"supportedCountries":[]},"chat":{"chats":{},"inbox":{"recents":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"strangers":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"friends":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"search":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"config":{"newCount":0,"strangerMessageSwitch":false,"strangerMessageUnread":false,"friendCount":0}},"global":{"isChatMqttExisted":false}},"emoticons":{"emoticonGroupList":[],"emoticonGroupDetail":{}},"creator":{"tools":{"question":{"invitationCount":{"questionFolloweeCount":0,"questionTotalCount":0}},"recommend":{"recommendTimes":{}}},"explore":{},"levelUpperLimit":10,"mcn":{},"mcnManage":{},"tasks":{},"announcement":{},"creatorsRecommendInfo":{}},"creators":{"common":{"applyStatus":{},"rightsStatus":{}},"bayesDomains":{"status":{},"options":{"topDomains":null,"allDomains":null,"editable":0},"contents":null},"school":{"tabs":[],"contents":[],"banner":null,"entities":{}},"faq":{"tabs":[],"article":{}},"knowledgeIncome":{},"safeguardRights":{},"analytics":{"all":{},"answer":{},"zvideo":{},"article":{},"pin":{},"singleContent":{}},"account":{"growthLevel":{}},"KMResource":{},"training":{},"ToolsQuestion":{"goodatTopics":[]},"ToolsHotspot":{"domains":[]},"ToolsRecommend":{},"ToolsCustomPromotion":{"itemLists":{},"baseInfo":{}},"ToolsSearchQuestion":{},"editorSetting":{},"MCNManage":{},"knowledgeTasks":{},"incomeAnalysis":{"income":{"aggregation":{}}},"creationManage":{"editModal":{"status":false}},"activity":{},"announcement":{},"home":{"currentCreatorUrlToken":null,"rights":[],"newRights":[],"scoreInfo":{},"menusShowControlByServer":{"bVipRecomend":false,"creationRelationship":false},"newTasks":{"creatorTask":{"tasks":[],"des":[]}},"bannerList":[],"recentlyCreated":[],"homecard":{},"homeData":{}},"videoSupport":{"textBenefit":{}},"videoDistribution":{},"profilePoster":{"creatorPosterConfig":{},"creatorPosterData":{}}},"answers":{"voters":{},"upvoters":{},"copyrightApplicants":{},"favlists":{},"newAnswer":{},"entityWords":{},"paidContent":{},"settings":{},"relationEndorsement":{}},"recommendation":{"homeRecommendations":[]},"shareTexts":{},"articles":{"voters":{},"upvoters":{},"relationEndorsement":{}},"previewPost":{},"favlists":{"relations":{}},"columns":{"voters":{}},"reward":{"answer":{},"article":{},"question":{}},"video":{"data":{},"shareVideoDetail":{},"last":{}},"topstory":{"recommend":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"follow":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followWonderful":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"sidebar":null,"announcement":{},"hotList":[],"hotListHeadZone":[],"guestFeeds":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followExtra":{"isNewUser":null,"isFetched":false,"followCount":0,"followers":[]},"hotDaily":{"data":[],"paging":{}},"hotHighlight":{"isFetching":false,"isDrained":false,"data":[],"paging":{}},"banner":{},"commercialBanner":{"show":false,"banner":{},"trackData":{}},"video":{"items":[],"next":null,"isLoading":false,"isDrained":false}},"readStatus":{},"column":{},"requestColumn":{"categories":[],"error":null},"articleContribution":{"contributeRequests":[],"deleteContributeIdList":[],"handledContributeIdList":[],"recommendedColumns":[],"pinnedColumns":[],"sentContributeRequestsIdList":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]},"columnContribution":{"contributeRequests":[],"autoInviteEnabled":false,"recommendedContributors":[]},"draftHistory":{"history":{},"drafts":{}},"upload":{},"articleDraft":{"titleImage":"","titleImageSize":{},"isTitleImageFullScreen":false,"canTitleImageFullScreen":false,"title":"","titleImageUploading":false,"error":"","content":"","draftLoading":false,"updating":false,"globalLoading":false,"pendingVideo":{"resource":null,"error":null},"deleteFail":{"fail":false},"recommendTopics":[],"selectedColumn":0,"articleDisclaimers":[]},"articleDrafts":{"isDrained":false,"isLoading":false,"items":[]},"columnAutocomplete":{"users":[],"friends":[]},"columnCollection":{},"userProfit":{"permission":{"permissionStatus":{"zhiZixuan":0,"recommend":-1,"task":0,"plugin":0,"infinity":0},"visible":false},"linkCardLimit":0},"mcn":{"bindInfo":{},"memberCategoryList":[],"producerList":[],"categoryList":[],"lists":{},"banners":{},"protocolStatus":{"isAgreedNew":true,"isAgreedOld":true},"probationCountdownDays":0},"zvideos":{"campaignVideoList":{},"campaigns":{},"tagoreCategory":[],"recommendations":{},"insertable":{},"recruit":{"form":{"platform":"","nickname":"","followerCount":"","domain":"","contact":""},"submited":false,"ranking":[]},"qyActivityData":{},"talkActivityData":{},"party2022ActivityData":{},"batchVideos":{},"contribution":{"selectedContribution":null,"campaign":null,"configs":{},"contributionLists":{},"recommendQuestions":{"isLoading":true,"paging":{"isEnd":false,"isStart":true,"totals":0},"data":[]},"questionSearchResults":{"isLoading":true,"paging":{"isEnd":false,"isStart":true,"totals":0},"data":[]}},"creationReferences":{},"zvideoCollection":{},"zvideoGrant":{},"collectData":{"isFetching":false,"list":[]},"videoSource":{"isLoaded":false}},"republish":{},"commentPermission":{},"creatorRightStatus":{"list":[]},"adPromotion":{"answer":{},"article":{}}},"fetchHost":"www.zhihu.com","subAppName":"column","spanName":"Post","canaryConfig":{"test_canary":"0","use_new_player":"0","player_vendor":"0","use_hevc":"1","upload_use_signature":"1","use_backdrop_blur":"1","article_title_imagex":"1","play_station":"1","use_cached_supported_countries":"1"}}</script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/vendor.b2043823c211547b094b.js"></script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/react.production.min.js"></script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/react-dom.production.min.js"></script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/react-dom-server.browser.production.min.js"></script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/runtime.app.dba9b98df4020bb2e842.js"></script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/lib-75fc9c18.app.3db651c252e14ef6658e.js"></script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/lib-29107295.app.42d07f814b7b05187671.js"></script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/lib-79b5cf47.app.8b6b6bf4b6d894db9b07.js"></script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/lib-330004dc.app.7437cf54ac28fca0e302.js"></script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/lib-f3572862.app.d7ec7e2db90ddb91c8f1.js"></script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/lib-0e5ce61e.app.b22b78c2be57c983262f.js"></script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/lib-83b0f42f.app.e34e650850a4762e3d73.js"></script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/lib-38cf5c11.app.0ef475c02226ac0ff291.js"></script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/lib-2ec050f6.app.57e8f4759cf809bee790.js"></script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/lib-9b20c40c.app.7c126d28f70d31bca659.js"></script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/3555.app.02d79a59c8a7d430d0c9.js"></script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/column.app.3dcfe5b4445ab79e4df9.js"></script><script defer="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/aria.js" id="ariascripts" wapforceoldfixed="false" loaddata="false"></script><script src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/hm.js" async=""></script><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/zap.js"></script><div><div style="display: none;"><i>想来知乎工作？请发送邮件到 jobs@zhihu.com</i></div></div><script src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/push.js"></script><div><div><div class="css-8pdeid"></div></div></div><script crossorigin="" src="./PyTorch保姆级CNN实现mnist手写数字识别 - 知乎_files/emoticon.js"></script><div><div><div class="Editable-languageSuggestions" style="left: -1179px; top: -999px;"><div><div class="Popover"><label class="Editable-languageSuggestionsInput Input-wrapper"><input autocomplete="off" role="combobox" aria-expanded="false" aria-autocomplete="list" aria-activedescendant="AutoComplete8-0" id="Popover7-toggle" aria-haspopup="true" class="Input" placeholder="选择语言" value=""><svg width="24" height="24" viewBox="0 0 24 24" fill="#afbdcf" class="Zi Zi--Select"><path fill-rule="evenodd" d="M12.53 3.47a.75.75 0 0 0-1.06 0l-5 5a.75.75 0 0 0 1.06 1.06L12 5.06l4.47 4.47a.75.75 0 1 0 1.06-1.06l-5-5Zm-5 11a.75.75 0 0 0-1.06 1.06l5 5a.75.75 0 0 0 1.06 0l5-5a.75.75 0 1 0-1.06-1.06L12 18.94l-4.47-4.47Z" clip-rule="evenodd"></path></svg></label></div></div></div></div></div></body></html>